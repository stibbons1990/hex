<!DOCTYPE html><html lang="en" class="no-js"><head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://stibbons1990.github.io/hex/blog/2025/12/21/monitoring-a-kubernetes-cluster-for-vulnerabilities/">
      
      
        <link rel="prev" href="../../18/replacing-ingress-nginx-with-pomerium/">
      
      
        <link rel="next" href="../../../../2026/01/10/upgrading-single-node-kubernetes-cluster-on-ubuntu-studio-2404-octavo/">
      
      
        
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Monitoring a Kubernetes cluster for vulnerabilities - Inadvisably Applied Magic</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-Y167L3ZVGY"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-Y167L3ZVGY",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-Y167L3ZVGY",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
  <link href="../../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../../../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#manual-monitoring-of-releases" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="Inadvisably Applied Magic" class="md-header__button md-logo" aria-label="Inadvisably Applied Magic" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="m64 400 85.7-208.2c17-41.3 47.8-75.3 87.2-96.3l146.9-78.3c12.3-6.6 26.5 4.7 23 18.2l-37.2 142.4c-1.1 4.1-1.6 8.3-1.6 12.6 0 6.3 1.2 12.6 3.6 18.5L448 400H240.9l11.8-35.4 40.4-13.5c6.5-2.2 10.9-8.3 10.9-15.2s-4.4-13-10.9-15.2l-40.4-13.5-13.5-40.4c-2.2-6.4-8.3-10.8-15.2-10.8s-13 4.4-15.2 10.9l-13.5 40.4-40.4 13.5c-6.5 2.2-10.9 8.3-10.9 15.2s4.4 13 10.9 15.2l40.4 13.5 11.8 35.4H64zm215.6-258.5c-1.1-3.3-4.1-5.5-7.6-5.5s-6.5 2.2-7.6 5.5l-6.7 20.2-20.2 6.7c-3.3 1.1-5.5 4.1-5.5 7.6s2.2 6.5 5.5 7.6l20.2 6.7 6.7 20.2c1.1 3.3 4.1 5.5 7.6 5.5s6.5-2.2 7.6-5.5l6.7-20.2 20.2-6.7c3.3-1.1 5.5-4.1 5.5-7.6s-2.2-6.5-5.5-7.6l-20.2-6.7zM32 448h448c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32"></path></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Inadvisably Applied Magic
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Monitoring a Kubernetes cluster for vulnerabilities
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="green" aria-label="Dark mode" type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"></path></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="green" aria-label="Light mode" type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"></path></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="Inadvisably Applied Magic" class="md-nav__button md-logo" aria-label="Inadvisably Applied Magic" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="m64 400 85.7-208.2c17-41.3 47.8-75.3 87.2-96.3l146.9-78.3c12.3-6.6 26.5 4.7 23 18.2l-37.2 142.4c-1.1 4.1-1.6 8.3-1.6 12.6 0 6.3 1.2 12.6 3.6 18.5L448 400H240.9l11.8-35.4 40.4-13.5c6.5-2.2 10.9-8.3 10.9-15.2s-4.4-13-10.9-15.2l-40.4-13.5-13.5-40.4c-2.2-6.4-8.3-10.8-15.2-10.8s-13 4.4-15.2 10.9l-13.5 40.4-40.4 13.5c-6.5 2.2-10.9 8.3-10.9 15.2s4.4 13 10.9 15.2l40.4 13.5 11.8 35.4H64zm215.6-258.5c-1.1-3.3-4.1-5.5-7.6-5.5s-6.5 2.2-7.6 5.5l-6.7 20.2-20.2 6.7c-3.3 1.1-5.5 4.1-5.5 7.6s2.2 6.5 5.5 7.6l20.2 6.7 6.7 20.2c1.1 3.3 4.1 5.5 7.6 5.5s6.5-2.2 7.6-5.5l6.7-20.2 20.2-6.7c3.3-1.1 5.5-4.1 5.5-7.6s-2.2-6.5-5.5-7.6l-20.2-6.7zM32 448h448c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32"></path></svg>

    </a>
    Inadvisably Applied Magic
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About This Place
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2">
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Projects
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Projects
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../projects/conmon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Continuous Monitoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../projects/self-hosting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Self-hosting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      <a href="../../../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Unexpected Linux Adventures
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#manual-monitoring-of-releases" class="md-nav__link">
    <span class="md-ellipsis">
      
        Manual monitoring of releases
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Manual monitoring of releases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#watch-github-repositories" class="md-nav__link">
    <span class="md-ellipsis">
      
        Watch GitHub repositories
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#newreleases" class="md-nav__link">
    <span class="md-ellipsis">
      
        new(releases)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manually-updating-a-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      
        Manually updating a deployment
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Manually updating a deployment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deployment-restart" class="md-nav__link">
    <span class="md-ellipsis">
      
        Deployment restart
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deployment-scale-downup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Deployment scale down/up
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Deployment scale down/up">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clean-up-discarded-replicasets" class="md-nav__link">
    <span class="md-ellipsis">
      
        Clean-up discarded replicasets
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-restart" class="md-nav__link">
    <span class="md-ellipsis">
      
        Node restart
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#automated-monitoring-of-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Automated monitoring of vulnerabilities
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Automated monitoring of vulnerabilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trivy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trivy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trivy-operator" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trivy Operator
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trivy-operator-dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trivy Operator Dashboard
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trivy-operator-dashboard-in-grafana" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trivy Operator Dashboard in Grafana
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Trivy Operator Dashboard in Grafana">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-grafana-data-source" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create Grafana Data source
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-grafana-dashboards" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create Grafana dashboards
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#automated-monitoring-of-releases" class="md-nav__link">
    <span class="md-ellipsis">
      
        Automated monitoring of releases
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Automated monitoring of releases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jetstack-version-checker" class="md-nav__link">
    <span class="md-ellipsis">
      
        Jetstack Version-Checker
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix-install-krew-and-tree" class="md-nav__link">
    <span class="md-ellipsis">
      
        Appendix: install krew and tree
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix-kube-bench" class="md-nav__link">
    <span class="md-ellipsis">
      
        Appendix: kube-bench
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix-more-grafana-dashboards-for-prometheous" class="md-nav__link">
    <span class="md-ellipsis">
      
        Appendix: more Grafana dashboards for Prometheous
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav md-nav--primary">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href="../../../../" class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
                  <span class="md-ellipsis">
                    Back to index
                  </span>
                </a>
              </div>
            </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__item--section">
                <div class="md-post__title">
                  <span class="md-ellipsis">
                    Metadata
                  </span>
                </div>
                <nav class="md-nav">
                  <ul class="md-nav__list">
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z"></path></svg>
                        <time datetime="2025-12-21 00:00:00+00:00" class="md-ellipsis">December 21, 2025</time>
                      </div>
                    </li>
                    
                    
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3zm3 2 4 13 3-1-4-13zM5 5v13h3V5zM3 19v2h18v-2z"></path></svg>
                          <span class="md-ellipsis">
                            in
                            
                              <a href="../../../../category/linux/">linux</a>, 
                              <a href="../../../../category/ubuntu/">Ubuntu</a>, 
                              <a href="../../../../category/server/">Server</a>, 
                              <a href="../../../../category/kubernetes/">kubernetes</a>, 
                              <a href="../../../../category/docker/">docker</a>, 
                              <a href="../../../../category/security/">security</a></span>
                        </div>
                      </li>
                    
                    
                      
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7z"></path></svg>
                          <span class="md-ellipsis">
                            
                              42 min read
                            
                          </span>
                        </div>
                      </li>
                    
                  </ul>
                </nav>
              </li>
            </ul>
            
          </nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        
  




  <h1>Monitoring a Kubernetes cluster for vulnerabilities</h1>

<p><a href="../../18/replacing-ingress-nginx-with-pomerium/">Replacing Ingress-NGINX with Pomerium</a>,
prompted by the upcoming
<a href="https://kubernetes.io/blog/2025/11/11/ingress-nginx-retirement/">retirement in March 2026</a>
of
<a href="https://github.com/kubernetes/ingress-nginx?tab=readme-ov-file#ingress-nginx-controller">Ingress-NGINX controller</a>,
was a stark reminder the importance of keeping deployments updated and staying abrest of
security issues, vulnerabilities and deprecations.</p>
<p>Manually monitoring each application's repository for new releases, to then update each
deployment manually, work well for a few deployments but does not scale well to dozens of
deployments. The process should be automated to automatically update deployments, at
last those with a good track record of hassle-free updates, so that manual updates are
needed only for those prone to requiring more attention, intermediate backups, etc.</p>
<!-- more -->

<h2 id="manual-monitoring-of-releases">Manual monitoring of releases</h2>
<p>Deployments that require special treatment during updates, and optionally those of
special interest, can be monitored manually for better visibility.</p>
<h3 id="watch-github-repositories">Watch GitHub repositories</h3>
<p>Source code repositories in GitHub can be <em>Watched</em> to reveive email notifcations when
new release, security alerts and/or other new publications are available. For the
purpose of keeping deployments up to date, keep an eye on releases and security alerts:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../../../media/2025-12-21-monitoring-a-kubernetes-cluster-for-vulnerabilities/github-watch.png" data-desc-position="bottom"><img alt="Watch options in GitHub" src="../../../../media/2025-12-21-monitoring-a-kubernetes-cluster-for-vulnerabilities/github-watch.png"></a></p>
<h3 id="newreleases"><code>new(releases)</code></h3>
<p><a href="https://newreleases.io/about"><strong><code>new(releases)</code></strong></a> is a simple service to get
notifications about new version releases from many programming platforms (GitHub,
GitLab, etc.) and docker registries (Docker Hub, Quay, etc.).  </p>
<p>To strike a balance between time saving of managing dependencies and annoyances by notifications, emails can sent in batches (frequency can set per project) and releases
can be filtered based on regular expressions (e.g. to ignore non-stable releases)
The main page shows the latest releases with projects sorted to show first those with
the most recent releases:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../../../media/2025-12-21-monitoring-a-kubernetes-cluster-for-vulnerabilities/new-releases.png" data-desc-position="bottom"><img alt="Summary of new(releases)" src="../../../../media/2025-12-21-monitoring-a-kubernetes-cluster-for-vulnerabilities/new-releases.png"></a></p>
<h2 id="manually-updating-a-deployment">Manually updating a deployment</h2>
<p>Once a new release for a Docker image is available, Kubernetes will automatically
update the deployment the next time it is <em>restarted</em>; depending on how the container
image version is specified, Kubernetes will pull the latest release that matches the
<em>tag</em> specified in each <code>container.image</code> — this may be the latest stable, major or
minor version.</p>
<h3 id="deployment-restart">Deployment restart</h3>
<p>Applications with no special requirements for a gradeceful shutdown can be udpated by
simply restarting the deployment, e.g. this will update
<a href="../../../../2024/02/28/audiobookshelf-on-kubernetes/">Audiobookshelf</a> in just a few seconds.</p>
<div class="language-console highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">$ </span>kubectl<span class="w"> </span>rollout<span class="w"> </span>restart<span class="w"> </span>deployment<span class="w"> </span>audiobookshelf<span class="w"> </span>-n<span class="w"> </span>audiobookshelf
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">deployment.apps/audiobookshelf restarted</span>
</span></code></pre></div>
<p>Although restarting the deployment is itself a fast operation (the new pod is ready in
about 10 seconds), it can disrupt the service for users in a few ways:</p>
<ul>
<li>If a user is listening to a book or podcast, their progress will no longer be saved
    until they reload te client application (web or mobile).</li>
<li>If the new version includes changes to user authentication, user will need to login
    again. This can also interrupt tracking progress and streaming media.</li>
</ul>
<p>To avoid such service disruptions to its users, Audiobookshelf is restarted daily at 5am
from a <code>crontab</code> (this is good enough because all the users are in the same time zone).</p>
<h3 id="deployment-scale-downup">Deployment scale down/up</h3>
<p>Applications that require a relatively long time to shut down, such as the
<a href="../../../../2023/08/10/running-minecraft-java-server-for-bedrock-clients-on-kubernetes/">Minecraft Java server</a>
which needs to <em>Save the World</em> during shut down, this alternative script can be used
to make sure the old pods hav enough time to gracefuly shutdown:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>$<span class="w"> </span>cat<span class="w"> </span>~/bin/restart-audiobookshelf<span class="w"> </span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="c1">#!/bin/bash</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>kubectl<span class="w"> </span>scale<span class="w"> </span>-n<span class="w"> </span>audiobookshelf<span class="w"> </span>deployment<span class="w"> </span>audiobookshelf<span class="w"> </span>--replicas<span class="o">=</span><span class="m">0</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>sleep<span class="w"> </span><span class="m">60</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>kubectl<span class="w"> </span>scale<span class="w"> </span>-n<span class="w"> </span>audiobookshelf<span class="w"> </span>deployment<span class="w"> </span>audiobookshelf<span class="w"> </span>--replicas<span class="o">=</span><span class="m">1</span>
</span></code></pre></div>
<p>This approach is <strong>necessary</strong> when it is recommended to make a full backup before
running the new version, e.g. this was neccessary to make full backes when
<a href="../../../../2024/12/31/migrating-unifi-controller-to-kubernetes/#december-2025-update-to-v10">updating UniFi from v9 to v10</a>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>When there is no need to make a full backup before running the new version, the slow
graceful shutdown is better accomplished by updating the deployment to set the
<code>Recreate</code> strategy so that running pods are shut down before starting new ones,
and ensure the old pod has enouth time to commit changes to local files by adding a
<code>lifecycle.preStop</code> that waits for a specific amount of time, similarly to
<a href="../../18/replacing-ingress-nginx-with-pomerium/#pebble-storage">Pomerium's Pebble storage setup</a>.</p>
</div>
<h4 id="clean-up-discarded-replicasets">Clean-up discarded <code>replicasets</code></h4>
<p>Restarting services with the above methods can lead to an accummulation of <em>empty</em>
old <code>replicasets</code> that can be deleted once the new version is running. It is possible
to reduce the history kept by the Deployment by setting <code>.spec.revisionHistoryLimit</code> in
Deployment manifests (the default is typically 10)s, that <code>replicasets</code> with 0 replicas
and no active pods are deleted through garbage collection once this limit is reached.</p>
<p>Alternatively, these can be deleted as a one-off with this script:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="ch">#!/bin/bash</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="c1">#</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="c1"># Delete unused replicasets.</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>kubectl<span class="w"> </span>get<span class="w"> </span>namespaces<span class="w"> </span>-o<span class="w"> </span>json<span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span>-r<span class="w"> </span><span class="s1">'.items[].metadata.name'</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="p">|</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>namespace<span class="p">;</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="w">  </span>kubectl<span class="w"> </span>get<span class="w"> </span>replicasets<span class="w"> </span>-n<span class="w"> </span><span class="nv">$namespace</span><span class="w"> </span>-o<span class="w"> </span>json<span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="w">  </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span>-r<span class="w"> </span><span class="s1">'.items[] | select(.status.replicas | contains(0))'</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="w">  </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span>-r<span class="w"> </span><span class="s1">'.metadata.name'</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>replicaset<span class="p">;</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="w">    </span>kubectl<span class="w"> </span>delete<span class="w"> </span>-n<span class="w"> </span><span class="nv">$namespace</span><span class="w"> </span>replicaset<span class="w"> </span><span class="nv">$replicaset</span><span class="w"> </span>--cascade<span class="o">=</span>background<span class="p">;</span><span class="w"> </span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="w">  </span><span class="k">done</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="k">done</span>
</span></code></pre></div>
<h3 id="node-restart">Node restart</h3>
<p>Restarting the entire server (Kuberneters <code>node</code>) would also update deployments to the
latest release available that matches their specified release tag. This can be done by
 restarting the entire server, or as part of the process to 
<a href="../../../01/10/upgrading-single-node-kubernetes-cluster-on-ubuntu-studio-2404-lexicon/">upgrade the kubernetes cluster to the next version</a>.</p>
<h2 id="automated-monitoring-of-vulnerabilities">Automated monitoring of vulnerabilities</h2>
<p><em>Presumably</em> a good reason to keep a service updated to the latest version is to deploy
fixes to bugs, including vulnerabilities. Whether that is actually true or not, that's
another story, and to understand this it becomes necessary to have a good view of what
vulnerabilities are actually present in the running versions of each service.</p>
<h3 id="trivy">Trivy</h3>
<p><a href="https://trivy.dev/">Trivy</a> is an extremely fast open-source scanner that can scan the
entire Kubernetes cluster or local images for vulnerabilities and misconfigurations.</p>
<p><a href="https://trivy.dev/docs/latest/getting-started/installation/#debianubuntu-official">Debian/Ubuntu (Official) packages</a> are easy to install as usual:</p>
<div class="language-console highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="gp"># </span>wget<span class="w"> </span>-qO<span class="w"> </span>-<span class="w"> </span>https://aquasecurity.github.io/trivy-repo/deb/public.key<span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">  </span><span class="p">|</span><span class="w"> </span>gpg<span class="w"> </span>--dearmor<span class="w"> </span><span class="p">|</span><span class="w">  </span>tee<span class="w"> </span>/usr/share/keyrings/trivy.gpg<span class="w"> </span>&gt;<span class="w"> </span>/dev/null
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="gp"># </span><span class="nb">echo</span><span class="w"> </span><span class="s2">"deb [signed-by=/usr/share/keyrings/trivy.gpg] https://aquasecurity.github.io/trivy-repo/deb generic main"</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">  </span><span class="p">|</span><span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/apt/sources.list.d/trivy.list
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="go">deb [signed-by=/usr/share/keyrings/trivy.gpg] https://aquasecurity.github.io/trivy-repo/deb generic main</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="gp"># </span>apt-get<span class="w"> </span>update
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="gp"># </span>apt-get<span class="w"> </span>install<span class="w"> </span>trivy<span class="w"> </span>-y
</span></code></pre></div>
<p>The <code>trivy</code> CLI can be used to audit several types of targets, for Kubernetes it can be
used directly on each Docker image, e.g.</p>
<div class="language-console highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="gp">$ </span>trivy<span class="w"> </span>image<span class="w"> </span>yobasystems/alpine-mariadb:latest
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="go">2025-12-24T17:25:29+01:00       INFO    [vuln] Vulnerability scanning is enabled</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="go">2025-12-24T17:25:29+01:00       INFO    [secret] Secret scanning is enabled</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="go">2025-12-24T17:25:29+01:00       INFO    [secret] If your scanning is slow, please try '--scanners vuln' to disable secret scanning</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="go">2025-12-24T17:25:29+01:00       INFO    [secret] Please see https://trivy.dev/docs/v0.68/guide/scanner/secret#recommendation for faster secret detection</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="go">2025-12-24T17:25:32+01:00       INFO    Detected OS     family="alpine" version="3.23.0"</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="go">2025-12-24T17:25:32+01:00       WARN    This OS version is not on the EOL list  family="alpine" version="3.23"</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="go">2025-12-24T17:25:32+01:00       INFO    [alpine] Detecting vulnerabilities...   os_version="3.23" repository="3.23" pkg_num=44</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="go">2025-12-24T17:25:32+01:00       INFO    Number of language-specific files       num=0</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="go">2025-12-24T17:25:32+01:00       WARN    Using severities from other vendors for some vulnerabilities. Read https://trivy.dev/docs/v0.68/guide/scanner/vulnerability#severity-selection for details.</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="go">Report Summary</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="go">┌───────────────────────────────────────────────────┬────────┬─────────────────┬─────────┐</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="go">│                      Target                       │  Type  │ Vulnerabilities │ Secrets │</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="go">├───────────────────────────────────────────────────┼────────┼─────────────────┼─────────┤</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="go">│ yobasystems/alpine-mariadb:latest (alpine 3.23.0) │ alpine │        1        │    -    │</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="go">└───────────────────────────────────────────────────┴────────┴─────────────────┴─────────┘</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="go">Legend:</span>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a><span class="go">- '-': Not scanned</span>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a><span class="go">- '0': Clean (no security findings detected)</span>
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a><span class="go">yobasystems/alpine-mariadb:latest (alpine 3.23.0)</span>
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a><span class="go">Total: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)</span>
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a>
</span><span id="__span-4-28"><a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a><span class="go">┌─────────┬────────────────┬──────────┬────────┬───────────────────┬───────────────┬────────────────────────────────────────────────────────────┐</span>
</span><span id="__span-4-29"><a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a><span class="go">│ Library │ Vulnerability  │ Severity │ Status │ Installed Version │ Fixed Version │                           Title                            │</span>
</span><span id="__span-4-30"><a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a><span class="go">├─────────┼────────────────┼──────────┼────────┼───────────────────┼───────────────┼────────────────────────────────────────────────────────────┤</span>
</span><span id="__span-4-31"><a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a><span class="go">│ c-ares  │ CVE-2025-62408 │ MEDIUM   │ fixed  │ 1.34.5-r0         │ 1.34.6-r0     │ c-ares: c-ares: Denial of Service due to query termination │</span>
</span><span id="__span-4-32"><a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a><span class="go">│         │                │          │        │                   │               │ after maximum attempts...                                  │</span>
</span><span id="__span-4-33"><a id="__codelineno-4-33" name="__codelineno-4-33" href="#__codelineno-4-33"></a><span class="go">│         │                │          │        │                   │               │ https://avd.aquasec.com/nvd/cve-2025-62408                 │</span>
</span><span id="__span-4-34"><a id="__codelineno-4-34" name="__codelineno-4-34" href="#__codelineno-4-34"></a><span class="go">└─────────┴────────────────┴──────────┴────────┴───────────────────┴───────────────┴────────────────────────────────────────────────────────────┘</span>
</span></code></pre></div>
<h3 id="trivy-operator">Trivy Operator</h3>
<p>The <a href="https://aquasecurity.github.io/trivy-operator/v0.29.0/">Trivy Operator</a> leverages
<a href="#trivy">Trivy</a> to continuously scan the Kubernetes cluster for security issues. The
scans are summarised in security reports as Kubernetes
<a href="https://aquasecurity.github.io/trivy-operator/latest/docs/crds/">Custom Resource Definitions (CRD)</a>,
which become accessible through the Kubernetes API. The Operator does this by watching
Kubernetes for state changes and automatically triggering security scans in response.
For example, a vulnerability scan is initiated when a new Pod is created. This way, users
can find and view the risks that relate to different resources in a Kubernetes-native way.</p>
<p>To install the operator using
<a href="https://aquasecurity.github.io/trivy-operator/v0.29.0/getting-started/installation/helm/">Helm</a>,
add the respository and then install the latest version in its own namespace:</p>
<div class="language-console highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="gp">$ </span>helm<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>aqua<span class="w"> </span>https://aquasecurity.github.io/helm-charts/
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="go">"aqua" has been added to your repositories</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="gp">$ </span>helm<span class="w"> </span>repo<span class="w"> </span>update
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="go">Hang tight while we grab the latest from your chart repositories...</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="go">...Successfully got an update from the "node-feature-discovery" chart repository</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="go">...Successfully got an update from the "kubernetes-dashboard" chart repository</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="go">...Successfully got an update from the "jetstack" chart repository</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="go">...Successfully got an update from the "aqua" chart repository</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="go">...Successfully got an update from the "ingress-nginx" chart repository</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="go">...Successfully got an update from the "intel" chart repository</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="go">...Successfully got an update from the "tailscale" chart repository</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="go">Update Complete. ⎈Happy Helming!⎈</span>
</span></code></pre></div>
<div class="admonition note">
<p class="admonition-title">The 0.31.0 is the latest version of the Helm chart.</p>
</div>
<div class="language-console highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="gp">$ </span>helm<span class="w"> </span>install<span class="w"> </span>trivy-operator<span class="w"> </span>aqua/trivy-operator<span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">     </span>--namespace<span class="w"> </span>trivy-system<span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">     </span>--create-namespace<span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">     </span>--version<span class="w"> </span><span class="m">0</span>.31.0
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="go">NAME: trivy-operator</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="go">LAST DEPLOYED: Sun Dec 21 11:25:21 2025</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="go">NAMESPACE: trivy-system</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="go">STATUS: deployed</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="go">REVISION: 1</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="go">TEST SUITE: None</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="go">NOTES:</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="go">You have installed Trivy Operator in the trivy-system namespace.</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="go">It is configured to discover Kubernetes workloads and resources in</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="go">all namespace(s).</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="go">Inspect created VulnerabilityReports by:</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="go">    kubectl get vulnerabilityreports --all-namespaces -o wide</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="go">Inspect created ConfigAuditReports by:</span>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="go">    kubectl get configauditreports --all-namespaces -o wide</span>
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a>
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a><span class="go">Inspect the work log of trivy-operator by:</span>
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a>
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a><span class="go">    kubectl logs -n trivy-system deployment/trivy-operator</span>
</span></code></pre></div>
<p>Right after installing there are no vulnerabilities to report <em>yet</em>, the operator will
need some time (several minutes) to scan the whole cluster:</p>
<div class="language-console highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="gp">$ </span>kubectl<span class="w"> </span>get<span class="w"> </span>vulnerabilityreports<span class="w"> </span>-A<span class="w"> </span>-o<span class="w"> </span>wide
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="go">No resources found</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="gp">$ </span>kubectl<span class="w"> </span>logs<span class="w"> </span>-n<span class="w"> </span>trivy-system<span class="w"> </span>deployment/trivy-operator
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="go">2025/12/21 10:25:25 maxprocs: Leaving GOMAXPROCS=16: CPU quota undefined</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="go">{"level":"info","ts":"2025-12-21T10:25:25Z","logger":"main","msg":"Starting operator","buildInfo":{"Version":"0.29.0","Commit":"c8b31d9428fe730da7f306e43abc45c3de904c94","Date":"2025-09-23T06:46:35Z","Executable":""}}</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="go">{"level":"info","ts":"2025-12-21T10:25:25Z","logger":"operator","msg":"Resolved install mode","install mode":"AllNamespaces","operator namespace":"trivy-system","target namespaces":[],"exclude namespaces":"","target workloads":["pod","replicaset","replicationcontroller","statefulset","daemonset","cronjob","job"]}</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="go">{"level":"info","ts":"2025-12-21T10:25:25Z","logger":"operator","msg":"Watching all namespaces"}</span>
</span></code></pre></div>
<p>Once the cluster has been scanned, <code>vulnerabilityreport</code> objects can be listed and
inspected via the Kubernetes API:</p>
<div class="language-console highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="gp">$ </span>kubectl<span class="w"> </span>get<span class="w"> </span>vulnerabilityreports<span class="w"> </span>-A<span class="w"> </span>-o<span class="w"> </span>wide
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="go">NAMESPACE                  NAME                                                              REPOSITORY                      TAG        SCANNER   AGE     CRITICAL   HIGH   MEDIUM   LOW   UNKNOWN</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="go">audiobookshelf             replicaset-audiobookshelf-b49c49757-audiobookshelf                advplyr/audiobookshelf          latest     Trivy     31s     1          14     11       15    0</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="go">cert-manager               replicaset-cert-manager-webhook-78cb4cf989-cert-manager-webhook   jetstack/cert-manager-webhook   v1.17.2    Trivy     46s     0          3      15       0     0</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="go">default                    pod-command-demo-command-demo-container                           library/debian                  latest     Trivy     2m12s   0          0      10       50    0</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="go">intel-device-plugins-gpu   daemonset-intel-gpu-plugin-gpudeviceplugin-intel-gpu-plugin       intel/intel-gpu-plugin          0.32.0     Trivy     2m13s   0          3      15       0     0</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="go">kube-flannel               daemonset-kube-flannel-ds-install-cni                             flannel-io/flannel              v0.26.7    Trivy     112s    0          9      44       5     2</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="go">kube-flannel               daemonset-kube-flannel-ds-kube-flannel                            flannel-io/flannel              v0.26.7    Trivy     2m7s    0          9      44       5     2</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="go">kube-system                daemonset-kube-proxy-kube-proxy                                   kube-proxy                      v1.32.4    Trivy     2m13s   1          12     36       17    0</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="go">kube-system                pod-etcd-octavo-etcd                                              etcd                            3.5.16-0   Trivy     104s    4          23     101      4     0</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="go">kube-system                pod-kube-apiserver-octavo-kube-apiserver                          kube-apiserver                  v1.32.4    Trivy     2m14s   1          9      33       0     0</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="go">kube-system                pod-kube-controller-manager-octavo-kube-controller-manager        kube-controller-manager         v1.32.4    Trivy     107s    1          12     33       0     0</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="go">kube-system                pod-kube-scheduler-octavo-kube-scheduler                          kube-scheduler                  v1.32.4    Trivy     2m13s   1          8      32       0     0</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="go">kube-system                replicaset-coredns-668d6bf9bc-coredns                             coredns/coredns                 v1.11.3    Trivy     16s     1          8      26       1     4</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="go">kubernetes-dashboard       replicaset-656764b68d                                             kubernetesui/dashboard-api      1.12.0     Trivy     2m13s   0          4      20       0     0</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="go">kubernetes-dashboard       replicaset-6c7c97c867                                             kubernetesui/dashboard-auth     1.2.4      Trivy     77s     0          6      21       0     0</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="go">kubernetes-dashboard       replicaset-f59b77564                                              kubernetesui/dashboard-web      1.6.2      Trivy     54s     0          5      21       0     0</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="go">kubernetes-dashboard       replicaset-kubernetes-dashboard-kong-79867c9c48-proxy             library/kong                    3.8        Trivy     59s     0          0      8        26    0</span>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="go">metallb-system             daemonset-speaker-speaker                                         metallb/speaker                 v0.14.9    Trivy     106s    0          11     55       0     0</span>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="go">monitoring                 replicaset-grafana-6fff9dbb6c-grafana                             grafana/grafana                 11.6.1     Trivy     37s     0          13     64       6     0</span>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a><span class="go">monitoring                 replicaset-influxdb-5974bf664f-influxdb                           library/influxdb                1.11.8     Trivy     67s     2          5      39       97    2</span>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a><span class="go">navidrome                  replicaset-navidrome-df8c9c769-navidrome                          deluan/navidrome                latest     Trivy     10s     0          0      3        7     0</span>
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a><span class="go">node-feature-discovery     daemonset-node-feature-discovery-worker-worker                    nfd/node-feature-discovery      v0.17.3    Trivy     103s    0          30     100      6     0</span>
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a><span class="go">node-feature-discovery     replicaset-node-feature-discovery-gc-5b65f7f5b6-gc                nfd/node-feature-discovery      v0.17.3    Trivy     43s     0          30     100      6     0</span>
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a><span class="go">pomerium                   job-pomerium-gen-secrets-gen-secrets                              pomerium/ingress-controller     main       Trivy     2m12s   0          0      0        8     0</span>
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a><span class="go">pomerium                   replicaset-pomerium-6b454bb8f9-pomerium                           pomerium/ingress-controller     v0.31.3    Trivy     73s     0          0      1        9     0</span>
</span><span id="__span-8-27"><a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a><span class="go">pomerium                   replicaset-verify-7889db6976-httpbin                              pomerium/verify                 latest     Trivy     78s     0          0      0        8     0</span>
</span><span id="__span-8-28"><a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a><span class="go">ryot                       replicaset-ryot-55c5845667-ryot                                   ignisda/ryot                    v8         Trivy     61s     2          19     90       92    1</span>
</span><span id="__span-8-29"><a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a><span class="go">tailscale                  replicaset-operator-748ccd7c75-operator                           tailscale/k8s-operator          v1.82.0    Trivy     16s     0          5      24       5     0</span>
</span><span id="__span-8-30"><a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a><span class="go">tailscale                  statefulset-7c5dc67989                                            tailscale/tailscale             v1.82.0    Trivy     2m13s   0          13     60       5     0</span>
</span><span id="__span-8-31"><a id="__codelineno-8-31" name="__codelineno-8-31" href="#__codelineno-8-31"></a><span class="go">tailscale                  statefulset-ts-home-assistant-tailscale-mdqlt-tailscale           tailscale/tailscale             v1.82.0    Trivy     2m14s   0          13     60       5     0</span>
</span><span id="__span-8-32"><a id="__codelineno-8-32" name="__codelineno-8-32" href="#__codelineno-8-32"></a><span class="go">trivy-system               replicaset-trivy-operator-59489786c6-trivy-operator               aquasec/trivy-operator          0.29.0     Trivy     106s    0          6      21       5     0</span>
</span></code></pre></div>
<p><a href="#appendix-install-krew-and-tree">Install <code>tree</code></a> to easily find the relevant reports for
each deployement:</p>
<div class="language-console highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="gp">$ </span>kubectl<span class="w"> </span>tree<span class="w"> </span>deployment<span class="w"> </span>unifi<span class="w"> </span>-n<span class="w"> </span>unifi
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="go">NAMESPACE  NAME                                                       READY  REASON  STATUS   AGE </span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="go">unifi      Deployment/unifi                                           -              -        237d</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="go">unifi      ├─ReplicaSet/unifi-584f4847c7                              -              -        237d</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="go">unifi      ├─ReplicaSet/unifi-67679795dd                              -              -        19h </span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="go">unifi      │ ├─ConfigAuditReport/replicaset-unifi-67679795dd          -              -        19h </span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="go">unifi      │ ├─ExposedSecretReport/replicaset-unifi-67679795dd-unifi  -              -        19h </span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="go">unifi      │ ├─Pod/unifi-67679795dd-bw2vg                             True           Current  19h </span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="go">unifi      │ ├─SbomReport/replicaset-unifi-67679795dd-unifi           -              -        19h </span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="go">unifi      │ └─VulnerabilityReport/replicaset-unifi-67679795dd-unifi  -              -        19h </span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="go">unifi      ├─ReplicaSet/unifi-7d44b599dc                              -              -        97d </span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="go">unifi      │ ├─ConfigAuditReport/replicaset-unifi-7d44b599dc          -              -        3d7h</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="go">unifi      │ ├─ExposedSecretReport/replicaset-unifi-7d44b599dc-unifi  -              -        3d6h</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="go">unifi      │ └─SbomReport/replicaset-unifi-7d44b599dc-unifi           -              -        3d6h</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="go">unifi      ├─ReplicaSet/unifi-8997b8865                               -              -        202d</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="go">unifi      └─ReplicaSet/unifi-bff88d4df                               -              -        98d </span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="gp">$ </span>kubectl<span class="w"> </span>tree<span class="w"> </span>deployment<span class="w"> </span>home-assistant<span class="w"> </span>-n<span class="w"> </span>home-assistant
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="go">NAMESPACE       NAME                                                                             READY  REASON  STATUS   AGE  </span>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a><span class="go">home-assistant  Deployment/home-assistant                                                        -              -        241d </span>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a><span class="go">home-assistant  └─ReplicaSet/home-assistant-77bf44c47b                                           -              -        241d </span>
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a><span class="go">home-assistant    ├─ConfigAuditReport/replicaset-home-assistant-77bf44c47b                       -              -        3d7h </span>
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a><span class="go">home-assistant    ├─ExposedSecretReport/replicaset-home-assistant-77bf44c47b-home-assistant-app  -              -        3d7h </span>
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a><span class="go">home-assistant    ├─Pod/home-assistant-77bf44c47b-trgrt                                          True           Current  144d </span>
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a><span class="go">home-assistant    ├─SbomReport/replicaset-home-assistant-77bf44c47b-home-assistant-app           -              -        3d7h </span>
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a><span class="go">home-assistant    └─VulnerabilityReport/replicaset-home-assistant-77bf44c47b-home-assistant-app  -              -        6h49m</span>
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a>
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a><span class="gp">$ </span>kubectl<span class="w"> </span>tree<span class="w"> </span>deployment<span class="w"> </span>audiobookshelf<span class="w"> </span>-n<span class="w"> </span>audiobookshelf
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a><span class="go">NAMESPACE       NAME                                                                        READY  REASON  STATUS   AGE </span>
</span><span id="__span-9-30"><a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a><span class="go">audiobookshelf  Deployment/audiobookshelf                                                   -              -        239d</span>
</span><span id="__span-9-31"><a id="__codelineno-9-31" name="__codelineno-9-31" href="#__codelineno-9-31"></a><span class="go">audiobookshelf  └─ReplicaSet/audiobookshelf-c6d46b54f                                       -              -        13h </span>
</span><span id="__span-9-32"><a id="__codelineno-9-32" name="__codelineno-9-32" href="#__codelineno-9-32"></a><span class="go">audiobookshelf    ├─ConfigAuditReport/replicaset-audiobookshelf-c6d46b54f                   -              -        13h </span>
</span><span id="__span-9-33"><a id="__codelineno-9-33" name="__codelineno-9-33" href="#__codelineno-9-33"></a><span class="go">audiobookshelf    ├─ExposedSecretReport/replicaset-audiobookshelf-c6d46b54f-audiobookshelf  -              -        13h </span>
</span><span id="__span-9-34"><a id="__codelineno-9-34" name="__codelineno-9-34" href="#__codelineno-9-34"></a><span class="go">audiobookshelf    ├─Pod/audiobookshelf-c6d46b54f-ngm8w                                      True           Current  13h </span>
</span><span id="__span-9-35"><a id="__codelineno-9-35" name="__codelineno-9-35" href="#__codelineno-9-35"></a><span class="go">audiobookshelf    ├─SbomReport/replicaset-audiobookshelf-c6d46b54f-audiobookshelf           -              -        13h </span>
</span><span id="__span-9-36"><a id="__codelineno-9-36" name="__codelineno-9-36" href="#__codelineno-9-36"></a><span class="go">audiobookshelf    └─VulnerabilityReport/replicaset-audiobookshelf-c6d46b54f-audiobookshelf  -              -        13h </span>
</span></code></pre></div>
<p>Use the <code>describe</code> command to inspect all details about each report. The output is often
very long, so here is a trick to filter it down to show only <code>CRITICAL</code> vulnerabilties:</p>
<div class="language-console highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="gp">$ </span>kubectl<span class="w"> </span>describe<span class="w"> </span>vulnerabilityreport<span class="w"> </span><span class="se">\</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">    </span>replicaset-audiobookshelf-c6d46b54f-audiobookshelf<span class="w"> </span><span class="se">\</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">    </span>-n<span class="w"> </span>audiobookshelf<span class="w"> </span><span class="se">\</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">    </span><span class="p">|</span><span class="w"> </span>egrep<span class="w"> </span>-B11<span class="w"> </span>-A1<span class="w"> </span>CRITICAL<span class="w"> </span><span class="p">|</span><span class="w"> </span>egrep<span class="w"> </span>--color<span class="w"> </span><span class="s1">'|.*Version.*|Title.*'</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="go">    Title:               follow-redirects: Possible credential leak</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="go">    Vulnerability ID:    CVE-2024-28849</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="go">    Fixed Version:       2.5.4, 3.0.4, 4.0.4</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="go">    Installed Version:   4.0.0</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="go">    Last Modified Date:  2025-11-03T20:19:20Z</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="go">    Links:</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="go">    Package PURL:        pkg:npm/form-data@4.0.0</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="go">    Primary Link:        https://avd.aquasec.com/nvd/cve-2025-7783</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="go">    Published Date:      2025-07-18T17:15:44Z</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="go">    Resource:            form-data</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="go">    Score:               5.4</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="go">    Severity:            CRITICAL</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="go">    Target:              </span>
</span></code></pre></div>
<h3 id="trivy-operator-dashboard">Trivy Operator Dashboard</h3>
<p><a href="https://github.com/raoulx24/trivy-operator-dashboard?tab=readme-ov-file#trivy-operator-dashboard">Trivy Operator Dashboard</a>
is a dedicate dashboard for the Trivy Pperator that comes with its own web UI
(not based on Grafana). The recommended
<a href="https://github.com/raoulx24/trivy-operator-dashboard/blob/master/docs/install-doc.md#installation">installation</a>
method is via Helm, with the following <code>trivy-operator-dashboard-values.yaml</code> to create
a Pomerium-based <code>Ingress</code>:</p>
<div class="language-yaml highlight"><span class="filename">prometheus/trivy-operator-dashboard-values.yaml</span><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="nt">ingress</span><span class="p">:</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">  </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">    </span><span class="nt">cert-manager.io/cluster-issuer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">letsencrypt-prod</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">    </span><span class="nt">ingress.pomerium.io/pass_identity_headers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">    </span><span class="nt">ingress.pomerium.io/secure_upstream</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">    </span><span class="nt">ingress.pomerium.io/tls_skip_verify</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">    </span><span class="nt">ingress.pomerium.io/policy</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="w">      </span><span class="no">- allow:</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">          </span><span class="no">or:</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="w">            </span><span class="no">- email:</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="w">                </span><span class="no">is: "admin-user@gmail.com"</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="w">  </span><span class="nt">className</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pomerium</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="w">  </span><span class="nt">tls</span><span class="p">:</span>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">secretName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tls-trivy-operator-dashboard</span>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="w">      </span><span class="nt">hosts</span><span class="p">:</span>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">trivy-operator-dashboard.very-very-dark-gray.top</span>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">trivy-operator-dashboard.very-very-dark-gray.top</span>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="w">      </span><span class="nt">paths</span><span class="p">:</span>
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a><span class="w">          </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
</span></code></pre></div>
<div class="language-console highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="gp">$ </span>helm<span class="w"> </span>install<span class="w"> </span>trivy-operator-dashboard<span class="w"> </span><span class="se">\</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="w">  </span>oci://ghcr.io/raoulx24/charts/trivy-operator-dashboard<span class="w"> </span><span class="se">\</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="w">  </span>--namespace<span class="w"> </span>monitoring<span class="w"> </span><span class="se">\</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="w">  </span>--version<span class="w"> </span><span class="m">1</span>.7.2<span class="w"> </span><span class="se">\</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="w">  </span>--values<span class="w"> </span>prometheus/trivy-operator-dashboard-values.yaml
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="go">Pulled: ghcr.io/raoulx24/charts/trivy-operator-dashboard:1.7.2</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="go">Digest: sha256:a7831877b6f3d2124312cffbf5839b0d4f8159abf3215c29f837a17d6a2f65b9</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="go">NAME: trivy-operator-dashboard</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="go">LAST DEPLOYED: Sun Dec 21 19:02:34 2025</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="go">NAMESPACE: monitoring</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="go">STATUS: deployed</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="go">REVISION: 1</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="go">NOTES:</span>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="go">1. Get the application URL by running these commands:</span>
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="go">  https://trivy-operator-dashboard.very-very-dark-gray.top/</span>
</span></code></pre></div>
<p>The dashboard is now available at
<a href="https://trivy-operator-dashboard.very-very-dark-gray.top">https://trivy-operator-dashboard.very-very-dark-gray.top</a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../../../media/2025-12-21-monitoring-a-kubernetes-cluster-for-vulnerabilities/trivy-operator-dashboard.png" data-desc-position="bottom"><img alt="Trivy Operator Dashboard" src="../../../../media/2025-12-21-monitoring-a-kubernetes-cluster-for-vulnerabilities/trivy-operator-dashboard.png"></a></p>
<h3 id="trivy-operator-dashboard-in-grafana">Trivy Operator Dashboard in Grafana</h3>
<p><a href="https://aquasecurity.github.io/trivy-operator/v0.11.0/tutorials/grafana-dashboard/">Trivy Operator Dashboard in Grafana</a>
makes all those reports easier to find and provides better <em>Big Picture</em> views of the
whole cluster, using <a href="https://prometheus.io/">Prometheus</a> to scrape those reports and
visualizing them on Grafana dashboards.</p>
<p>Prometheus and Grafana can easily be installed through the kube-prometheus-stack
<a href="https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack">Helm Chart</a>,
but Grafana is already installed so it is only necessary to install Prometheus.
To omit Grafana it, create a custom <code>prometheus/values.yaml</code> file to disable the Grafana
component:</p>
<div class="language-yaml highlight"><span class="filename">prometheus/values.yaml</span><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1"># Disable Grafana installation</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="nt">grafana</span><span class="p">:</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">  </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="c1"># Ensure Prometheus can find the Trivy ServiceMonitors</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="nt">prometheus</span><span class="p">:</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="w">  </span><span class="nt">prometheusSpec</span><span class="p">:</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="w">    </span><span class="nt">serviceMonitorSelectorNilUsesHelmValues</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="w">    </span><span class="nt">serviceMonitorSelector</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="w">    </span><span class="nt">serviceMonitorNamespaceSelector</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</span></code></pre></div>
<p>Add the repository:</p>
<div class="language-console highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="gp">$ </span>helm<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>prometheus-community<span class="w"> </span>https://prometheus-community.github.io/helm-charts
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="go">"prometheus-community" has been added to your repositories</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="gp">$ </span>helm<span class="w"> </span>repo<span class="w"> </span>update
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="go">Hang tight while we grab the latest from your chart repositories...</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="go">...</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="go">...Successfully got an update from the "prometheus-community" chart repository</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="go">Update Complete. ⎈Happy Helming!⎈</span>
</span></code></pre></div>
<p>Install the stack in the existing <code>monitoring</code> namespace where Grafana is running,
using the above <code>prometheus/values.yaml</code> to omit installing Grafana:</p>
<div class="language-console highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="gp">$ </span>helm<span class="w"> </span>upgrade<span class="w"> </span>--install<span class="w"> </span>prom<span class="w"> </span>prometheus-community/kube-prometheus-stack<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="w">  </span>--namespace<span class="w"> </span>monitoring<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">  </span>--values<span class="w"> </span>prometheus/values.yaml
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="go">Release "prom" does not exist. Installing it now.</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="go">NAME: prom</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="go">LAST DEPLOYED: Sun Dec 21 13:32:07 2025</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="go">NAMESPACE: monitoring</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="go">STATUS: deployed</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="go">REVISION: 1</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="go">TEST SUITE: None</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="go">NOTES:</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="go">kube-prometheus-stack has been installed. Check its status by running:</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="go">  kubectl --namespace monitoring get pods -l "release=prom"</span>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="go">Get Grafana 'admin' user password by running:</span>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a>
</span><span id="__span-15-18"><a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a><span class="go">  kubectl --namespace monitoring get secrets prom-grafana -o jsonpath="{.data.admin-password}" | base64 -d ; echo</span>
</span><span id="__span-15-19"><a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a>
</span><span id="__span-15-20"><a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a><span class="go">Access Grafana local instance:</span>
</span><span id="__span-15-21"><a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a>
</span><span id="__span-15-22"><a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a><span class="go">  export POD_NAME=$(kubectl --namespace monitoring get pod -l "app.kubernetes.io/name=grafana,app.kubernetes.io/instance=prom" -oname)</span>
</span><span id="__span-15-23"><a id="__codelineno-15-23" name="__codelineno-15-23" href="#__codelineno-15-23"></a><span class="go">  kubectl --namespace monitoring port-forward $POD_NAME 3000</span>
</span><span id="__span-15-24"><a id="__codelineno-15-24" name="__codelineno-15-24" href="#__codelineno-15-24"></a>
</span><span id="__span-15-25"><a id="__codelineno-15-25" name="__codelineno-15-25" href="#__codelineno-15-25"></a><span class="go">Get your grafana admin user password by running:</span>
</span><span id="__span-15-26"><a id="__codelineno-15-26" name="__codelineno-15-26" href="#__codelineno-15-26"></a>
</span><span id="__span-15-27"><a id="__codelineno-15-27" name="__codelineno-15-27" href="#__codelineno-15-27"></a><span class="go">  kubectl get secret --namespace monitoring -l app.kubernetes.io/component=admin-secret -o jsonpath="{.items[0].data.admin-password}" | base64 --decode ; echo</span>
</span><span id="__span-15-28"><a id="__codelineno-15-28" name="__codelineno-15-28" href="#__codelineno-15-28"></a>
</span><span id="__span-15-29"><a id="__codelineno-15-29" name="__codelineno-15-29" href="#__codelineno-15-29"></a>
</span><span id="__span-15-30"><a id="__codelineno-15-30" name="__codelineno-15-30" href="#__codelineno-15-30"></a><span class="go">Visit https://github.com/prometheus-operator/kube-prometheus for instructions on how to create &amp; configure Alertmanager and Prometheus instances using the Operator.</span>
</span></code></pre></div>
<p>The instructions referring to the Grafana dashboards can be ignored, they are only
relevant when installing Grafana from this Helm chart.</p>
<p>Then update the Trivy Operator to expoort its metrics to Prometheus, by upgrading the
Helm chart with the following <code>trivy-values.yaml</code>:</p>
<div class="language-yaml highlight"><span class="filename">prometheus/trivy-values.yaml</span><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="nt">serviceMonitor</span><span class="p">:</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="w">  </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span></code></pre></div>
<div class="language-console highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="gp">$ </span>helm<span class="w"> </span>upgrade<span class="w"> </span><span class="se">\</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="w">  </span>trivy-operator<span class="w"> </span>aqua/trivy-operator<span class="w"> </span><span class="se">\</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="w">  </span>-n<span class="w"> </span>trivy-system<span class="w"> </span><span class="se">\</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="w">  </span>--values<span class="w"> </span>prometheus/trivy-values.yaml
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="go">Release "trivy-operator" has been upgraded. Happy Helming!</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="go">NAME: trivy-operator</span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="go">LAST DEPLOYED: Sun Dec 21 13:37:38 2025</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a><span class="go">NAMESPACE: trivy-system</span>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="go">STATUS: deployed</span>
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a><span class="go">REVISION: 2</span>
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a><span class="go">TEST SUITE: None</span>
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a><span class="go">NOTES:</span>
</span><span id="__span-17-14"><a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a><span class="go">You have installed Trivy Operator in the trivy-system namespace.</span>
</span><span id="__span-17-15"><a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a><span class="go">It is configured to discover Kubernetes workloads and resources in</span>
</span><span id="__span-17-16"><a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a><span class="go">all namespace(s).</span>
</span><span id="__span-17-17"><a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a>
</span><span id="__span-17-18"><a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a><span class="go">Inspect created VulnerabilityReports by:</span>
</span><span id="__span-17-19"><a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a>
</span><span id="__span-17-20"><a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a><span class="go">    kubectl get vulnerabilityreports --all-namespaces -o wide</span>
</span><span id="__span-17-21"><a id="__codelineno-17-21" name="__codelineno-17-21" href="#__codelineno-17-21"></a>
</span><span id="__span-17-22"><a id="__codelineno-17-22" name="__codelineno-17-22" href="#__codelineno-17-22"></a><span class="go">Inspect created ConfigAuditReports by:</span>
</span><span id="__span-17-23"><a id="__codelineno-17-23" name="__codelineno-17-23" href="#__codelineno-17-23"></a>
</span><span id="__span-17-24"><a id="__codelineno-17-24" name="__codelineno-17-24" href="#__codelineno-17-24"></a><span class="go">    kubectl get configauditreports --all-namespaces -o wide</span>
</span><span id="__span-17-25"><a id="__codelineno-17-25" name="__codelineno-17-25" href="#__codelineno-17-25"></a>
</span><span id="__span-17-26"><a id="__codelineno-17-26" name="__codelineno-17-26" href="#__codelineno-17-26"></a><span class="go">Inspect the work log of trivy-operator by:</span>
</span><span id="__span-17-27"><a id="__codelineno-17-27" name="__codelineno-17-27" href="#__codelineno-17-27"></a>
</span><span id="__span-17-28"><a id="__codelineno-17-28" name="__codelineno-17-28" href="#__codelineno-17-28"></a><span class="go">    kubectl logs -n trivy-system deployment/trivy-operator</span>
</span></code></pre></div>
<p>This update to the Trivy operator Helm values leads to the creation of its
<code>ServiceMonitor</code>:</p>
<div class="language-console highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="gp">$ </span>kubectl<span class="w"> </span>describe<span class="w"> </span>servicemonitor<span class="w"> </span>trivy-operator<span class="w"> </span>-n<span class="w"> </span>trivy-system<span class="w"> </span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="go">Name:         trivy-operator</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="go">Namespace:    trivy-system</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="go">Labels:       app.kubernetes.io/instance=trivy-operator</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="go">              app.kubernetes.io/managed-by=Helm</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="go">              app.kubernetes.io/name=trivy-operator</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="go">              app.kubernetes.io/version=0.29.0</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="go">              helm.sh/chart=trivy-operator-0.31.0</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="go">Annotations:  meta.helm.sh/release-name: trivy-operator</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="go">              meta.helm.sh/release-namespace: trivy-system</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="go">API Version:  monitoring.coreos.com/v1</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="hll"><span class="go">Kind:         ServiceMonitor</span>
</span></span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="go">Metadata:</span>
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="go">  Creation Timestamp:  2025-12-21T12:37:39Z</span>
</span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a><span class="go">  Generation:          1</span>
</span><span id="__span-18-16"><a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a><span class="go">  Resource Version:    52316470</span>
</span><span id="__span-18-17"><a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a><span class="go">  UID:                 610823f7-b6bd-459f-a6c7-8b5c18bf1ae4</span>
</span><span id="__span-18-18"><a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a><span class="go">Spec:</span>
</span><span id="__span-18-19"><a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a><span class="go">  Endpoints:</span>
</span><span id="__span-18-20"><a id="__codelineno-18-20" name="__codelineno-18-20" href="#__codelineno-18-20"></a><span class="go">    Honor Labels:  true</span>
</span><span id="__span-18-21"><a id="__codelineno-18-21" name="__codelineno-18-21" href="#__codelineno-18-21"></a><span class="go">    Port:          metrics</span>
</span><span id="__span-18-22"><a id="__codelineno-18-22" name="__codelineno-18-22" href="#__codelineno-18-22"></a><span class="go">    Scheme:        http</span>
</span><span id="__span-18-23"><a id="__codelineno-18-23" name="__codelineno-18-23" href="#__codelineno-18-23"></a><span class="go">  Selector:</span>
</span><span id="__span-18-24"><a id="__codelineno-18-24" name="__codelineno-18-24" href="#__codelineno-18-24"></a><span class="go">    Match Labels:</span>
</span><span id="__span-18-25"><a id="__codelineno-18-25" name="__codelineno-18-25" href="#__codelineno-18-25"></a><span class="go">      app.kubernetes.io/instance:  trivy-operator</span>
</span><span id="__span-18-26"><a id="__codelineno-18-26" name="__codelineno-18-26" href="#__codelineno-18-26"></a><span class="go">      app.kubernetes.io/name:      trivy-operator</span>
</span><span id="__span-18-27"><a id="__codelineno-18-27" name="__codelineno-18-27" href="#__codelineno-18-27"></a><span class="go">Events:                            &lt;none&gt;</span>
</span></code></pre></div>
<div class="language-console highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="gp">$ </span>kubectl<span class="w"> </span>get<span class="w"> </span>all<span class="w"> </span>-n<span class="w"> </span>monitoring
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="go">NAME                                                         READY   STATUS    RESTARTS      AGE</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="go">pod/alertmanager-prom-kube-prometheus-stack-alertmanager-0   2/2     Running   0             7m7s</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="go">pod/grafana-6fff9dbb6c-v22hg                                 1/1     Running   19 (9d ago)   237d</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="go">pod/influxdb-5974bf664f-8r5mf                                1/1     Running   19 (9d ago)   237d</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="go">pod/prom-kube-prometheus-stack-operator-645fd684d6-n6qpf     1/1     Running   0             7m12s</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="go">pod/prom-kube-state-metrics-8576986c6b-xqcwl                 1/1     Running   0             7m12s</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="go">pod/prom-prometheus-node-exporter-r24zl                      1/1     Running   0             7m13s</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="go">pod/prometheus-prom-kube-prometheus-stack-prometheus-0       2/2     Running   0             7m7s</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="go">NAME                                              TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)                      AGE</span>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="go">service/alertmanager-operated                     ClusterIP   None             &lt;none&gt;        9093/TCP,9094/TCP,9094/UDP   7m8s</span>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="go">service/grafana-svc                               NodePort    10.110.29.239    &lt;none&gt;        13000:30300/TCP              237d</span>
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a><span class="go">service/influxdb-svc                              NodePort    10.110.65.108    &lt;none&gt;        18086:30086/TCP              237d</span>
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a><span class="go">service/prom-kube-prometheus-stack-alertmanager   ClusterIP   10.100.199.60    &lt;none&gt;        9093/TCP,8080/TCP            7m13s</span>
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a><span class="go">service/prom-kube-prometheus-stack-operator       ClusterIP   10.107.124.226   &lt;none&gt;        443/TCP                      7m13s</span>
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a><span class="go">service/prom-kube-prometheus-stack-prometheus     ClusterIP   10.110.216.0     &lt;none&gt;        9090/TCP,8080/TCP            7m13s</span>
</span><span id="__span-19-18"><a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a><span class="go">service/prom-kube-state-metrics                   ClusterIP   10.96.142.254    &lt;none&gt;        8080/TCP                     7m13s</span>
</span><span id="__span-19-19"><a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a><span class="go">service/prom-prometheus-node-exporter             ClusterIP   10.97.182.188    &lt;none&gt;        9100/TCP                     7m13s</span>
</span><span id="__span-19-20"><a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a><span class="go">service/prometheus-operated                       ClusterIP   None             &lt;none&gt;        9090/TCP                     7m7s</span>
</span><span id="__span-19-21"><a id="__codelineno-19-21" name="__codelineno-19-21" href="#__codelineno-19-21"></a>
</span><span id="__span-19-22"><a id="__codelineno-19-22" name="__codelineno-19-22" href="#__codelineno-19-22"></a><span class="go">NAME                                           DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR            AGE</span>
</span><span id="__span-19-23"><a id="__codelineno-19-23" name="__codelineno-19-23" href="#__codelineno-19-23"></a><span class="go">daemonset.apps/prom-prometheus-node-exporter   1         1         1       1            1           kubernetes.io/os=linux   7m13s</span>
</span><span id="__span-19-24"><a id="__codelineno-19-24" name="__codelineno-19-24" href="#__codelineno-19-24"></a>
</span><span id="__span-19-25"><a id="__codelineno-19-25" name="__codelineno-19-25" href="#__codelineno-19-25"></a><span class="go">NAME                                                  READY   UP-TO-DATE   AVAILABLE   AGE</span>
</span><span id="__span-19-26"><a id="__codelineno-19-26" name="__codelineno-19-26" href="#__codelineno-19-26"></a><span class="go">deployment.apps/grafana                               1/1     1            1           237d</span>
</span><span id="__span-19-27"><a id="__codelineno-19-27" name="__codelineno-19-27" href="#__codelineno-19-27"></a><span class="go">deployment.apps/influxdb                              1/1     1            1           237d</span>
</span><span id="__span-19-28"><a id="__codelineno-19-28" name="__codelineno-19-28" href="#__codelineno-19-28"></a><span class="go">deployment.apps/prom-kube-prometheus-stack-operator   1/1     1            1           7m13s</span>
</span><span id="__span-19-29"><a id="__codelineno-19-29" name="__codelineno-19-29" href="#__codelineno-19-29"></a><span class="go">deployment.apps/prom-kube-state-metrics               1/1     1            1           7m13s</span>
</span><span id="__span-19-30"><a id="__codelineno-19-30" name="__codelineno-19-30" href="#__codelineno-19-30"></a>
</span><span id="__span-19-31"><a id="__codelineno-19-31" name="__codelineno-19-31" href="#__codelineno-19-31"></a><span class="go">NAME                                                             DESIRED   CURRENT   READY   AGE</span>
</span><span id="__span-19-32"><a id="__codelineno-19-32" name="__codelineno-19-32" href="#__codelineno-19-32"></a><span class="go">replicaset.apps/grafana-6fff9dbb6c                               1         1         1       237d</span>
</span><span id="__span-19-33"><a id="__codelineno-19-33" name="__codelineno-19-33" href="#__codelineno-19-33"></a><span class="go">replicaset.apps/influxdb-5974bf664f                              1         1         1       237d</span>
</span><span id="__span-19-34"><a id="__codelineno-19-34" name="__codelineno-19-34" href="#__codelineno-19-34"></a><span class="go">replicaset.apps/prom-kube-prometheus-stack-operator-645fd684d6   1         1         1       7m13s</span>
</span><span id="__span-19-35"><a id="__codelineno-19-35" name="__codelineno-19-35" href="#__codelineno-19-35"></a><span class="go">replicaset.apps/prom-kube-state-metrics-8576986c6b               1         1         1       7m13s</span>
</span><span id="__span-19-36"><a id="__codelineno-19-36" name="__codelineno-19-36" href="#__codelineno-19-36"></a>
</span><span id="__span-19-37"><a id="__codelineno-19-37" name="__codelineno-19-37" href="#__codelineno-19-37"></a><span class="go">NAME                                                                    READY   AGE</span>
</span><span id="__span-19-38"><a id="__codelineno-19-38" name="__codelineno-19-38" href="#__codelineno-19-38"></a><span class="go">statefulset.apps/alertmanager-prom-kube-prometheus-stack-alertmanager   1/1     7m8s</span>
</span><span id="__span-19-39"><a id="__codelineno-19-39" name="__codelineno-19-39" href="#__codelineno-19-39"></a><span class="go">statefulset.apps/prometheus-prom-kube-prometheus-stack-prometheus       1/1     7m7s</span>
</span></code></pre></div>
<div class="language-console highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="gp">$ </span>kubectl<span class="w"> </span>get<span class="w"> </span>svc<span class="w"> </span>-n<span class="w"> </span>monitoring<span class="w"> </span>-o<span class="w"> </span>wide
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="go">NAME                                      TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)                      AGE     SELECTOR</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="go">alertmanager-operated                     ClusterIP   None             &lt;none&gt;        9093/TCP,9094/TCP,9094/UDP   7m35s   app.kubernetes.io/name=alertmanager</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="go">grafana-svc                               NodePort    10.110.29.239    &lt;none&gt;        13000:30300/TCP              237d    app=grafana</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="go">influxdb-svc                              NodePort    10.110.65.108    &lt;none&gt;        18086:30086/TCP              237d    app=influxdb</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="go">prom-kube-prometheus-stack-alertmanager   ClusterIP   10.100.199.60    &lt;none&gt;        9093/TCP,8080/TCP            7m40s   alertmanager=prom-kube-prometheus-stack-alertmanager,app.kubernetes.io/name=alertmanager</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="go">prom-kube-prometheus-stack-operator       ClusterIP   10.107.124.226   &lt;none&gt;        443/TCP                      7m40s   app=kube-prometheus-stack-operator,release=prom</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="go">prom-kube-prometheus-stack-prometheus     ClusterIP   10.110.216.0     &lt;none&gt;        9090/TCP,8080/TCP            7m40s   app.kubernetes.io/name=prometheus,operator.prometheus.io/name=prom-kube-prometheus-stack-prometheus</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="go">prom-kube-state-metrics                   ClusterIP   10.96.142.254    &lt;none&gt;        8080/TCP                     7m40s   app.kubernetes.io/instance=prom,app.kubernetes.io/name=kube-state-metrics</span>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="go">prom-prometheus-node-exporter             ClusterIP   10.97.182.188    &lt;none&gt;        9100/TCP                     7m40s   app.kubernetes.io/instance=prom,app.kubernetes.io/name=prometheus-node-exporter</span>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="go">prometheus-operated                       ClusterIP   None             &lt;none&gt;        9090/TCP                     7m34s   app.kubernetes.io/name=prometheus</span>
</span></code></pre></div>
<h4 id="create-grafana-data-source">Create Grafana Data source</h4>
<p>Once Prometheus is running there are two ways to connec the existing grafana to it:</p>
<ul>
<li>If both services are running in the same cluster, an internal URL can be used to
    connect based on the <code>prom-kube-prometheus-stack-prometheus</code> <strong>service</strong> at
    <a href="http://prom-kube-prometheus-stack-prometheus.monitoring.svc:9090">http://prom-kube-prometheus-stack-prometheus.monitoring.svc:9090</a></li>
<li>
<p>If a public endpoint is otherwise needed to reach Prometheous, create an <code>Ingress</code>
    for the Prometheus service:</p>
<details class="k8s">
<summary>Additional <code>Ingress</code> for the Prometheus service.</summary>
<div class="language-yaml highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">pomerium/pomerium-ingress/monitoring.yaml</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-54">54</a></span>
<span class="normal"><a href="#__codelineno-21-55">55</a></span>
<span class="normal"><a href="#__codelineno-21-56">56</a></span>
<span class="normal"><a href="#__codelineno-21-57">57</a></span>
<span class="normal"><a href="#__codelineno-21-58">58</a></span>
<span class="normal"><a href="#__codelineno-21-59">59</a></span>
<span class="normal"><a href="#__codelineno-21-60">60</a></span>
<span class="normal"><a href="#__codelineno-21-61">61</a></span>
<span class="normal"><a href="#__codelineno-21-62">62</a></span>
<span class="normal"><a href="#__codelineno-21-63">63</a></span>
<span class="normal"><a href="#__codelineno-21-64">64</a></span>
<span class="normal"><a href="#__codelineno-21-65">65</a></span>
<span class="normal"><a href="#__codelineno-21-66">66</a></span>
<span class="normal"><a href="#__codelineno-21-67">67</a></span>
<span class="normal"><a href="#__codelineno-21-68">68</a></span>
<span class="normal"><a href="#__codelineno-21-69">69</a></span>
<span class="normal"><a href="#__codelineno-21-70">70</a></span>
<span class="normal"><a href="#__codelineno-21-71">71</a></span>
<span class="normal"><a href="#__codelineno-21-72">72</a></span>
<span class="normal"><a href="#__codelineno-21-73">73</a></span>
<span class="normal"><a href="#__codelineno-21-74">74</a></span>
<span class="normal"><a href="#__codelineno-21-75">75</a></span>
<span class="normal"><a href="#__codelineno-21-76">76</a></span>
<span class="normal"><a href="#__codelineno-21-77">77</a></span>
<span class="normal"><a href="#__codelineno-21-78">78</a></span>
<span class="normal"><a href="#__codelineno-21-79">79</a></span>
<span class="normal"><a href="#__codelineno-21-80">80</a></span>
<span class="normal"><a href="#__codelineno-21-81">81</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-21-54"><a id="__codelineno-21-54" name="__codelineno-21-54"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
</span><span id="__span-21-55"><a id="__codelineno-21-55" name="__codelineno-21-55"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
</span><span id="__span-21-56"><a id="__codelineno-21-56" name="__codelineno-21-56"></a><span class="nt">metadata</span><span class="p">:</span>
</span><span id="__span-21-57"><a id="__codelineno-21-57" name="__codelineno-21-57"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prometheus-pomerium-ingress</span>
</span><span id="__span-21-58"><a id="__codelineno-21-58" name="__codelineno-21-58"></a><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">monitoring</span>
</span><span id="__span-21-59"><a id="__codelineno-21-59" name="__codelineno-21-59"></a><span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
</span><span id="__span-21-60"><a id="__codelineno-21-60" name="__codelineno-21-60"></a><span class="w">    </span><span class="nt">cert-manager.io/cluster-issuer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">letsencrypt-prod</span>
</span><span id="__span-21-61"><a id="__codelineno-21-61" name="__codelineno-21-61"></a><span class="w">    </span><span class="nt">ingress.pomerium.io/allow_public_unauthenticated_access</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-21-62"><a id="__codelineno-21-62" name="__codelineno-21-62"></a><span class="w">    </span><span class="nt">ingress.pomerium.io/allow_websockets</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-21-63"><a id="__codelineno-21-63" name="__codelineno-21-63"></a><span class="w">    </span><span class="nt">ingress.pomerium.io/pass_identity_headers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-21-64"><a id="__codelineno-21-64" name="__codelineno-21-64"></a><span class="w">    </span><span class="nt">ingress.pomerium.io/preserve_host_header</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-21-65"><a id="__codelineno-21-65" name="__codelineno-21-65"></a><span class="nt">spec</span><span class="p">:</span>
</span><span id="__span-21-66"><a id="__codelineno-21-66" name="__codelineno-21-66"></a><span class="w">  </span><span class="nt">ingressClassName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pomerium</span>
</span><span id="__span-21-67"><a id="__codelineno-21-67" name="__codelineno-21-67"></a><span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
</span><span id="__span-21-68"><a id="__codelineno-21-68" name="__codelineno-21-68"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prometheus.very-very-dark-gray.top</span>
</span><span id="__span-21-69"><a id="__codelineno-21-69" name="__codelineno-21-69"></a><span class="w">      </span><span class="nt">http</span><span class="p">:</span>
</span><span id="__span-21-70"><a id="__codelineno-21-70" name="__codelineno-21-70"></a><span class="w">        </span><span class="nt">paths</span><span class="p">:</span>
</span><span id="__span-21-71"><a id="__codelineno-21-71" name="__codelineno-21-71"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
</span><span id="__span-21-72"><a id="__codelineno-21-72" name="__codelineno-21-72"></a><span class="w">          </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
</span><span id="__span-21-73"><a id="__codelineno-21-73" name="__codelineno-21-73"></a><span class="w">          </span><span class="nt">backend</span><span class="p">:</span>
</span><span id="__span-21-74"><a id="__codelineno-21-74" name="__codelineno-21-74"></a><span class="w">            </span><span class="nt">service</span><span class="p">:</span>
</span><span id="__span-21-75"><a id="__codelineno-21-75" name="__codelineno-21-75"></a><span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prom-kube-prometheus-stack-prometheus</span>
</span><span id="__span-21-76"><a id="__codelineno-21-76" name="__codelineno-21-76"></a><span class="w">              </span><span class="nt">port</span><span class="p">:</span>
</span><span id="__span-21-77"><a id="__codelineno-21-77" name="__codelineno-21-77"></a><span class="w">                </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9090</span>
</span><span id="__span-21-78"><a id="__codelineno-21-78" name="__codelineno-21-78"></a><span class="w">  </span><span class="nt">tls</span><span class="p">:</span>
</span><span id="__span-21-79"><a id="__codelineno-21-79" name="__codelineno-21-79"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span>
</span><span id="__span-21-80"><a id="__codelineno-21-80" name="__codelineno-21-80"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prometheus.very-very-dark-gray.top</span>
</span><span id="__span-21-81"><a id="__codelineno-21-81" name="__codelineno-21-81"></a><span class="w">      </span><span class="nt">secretName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tls-secret</span>
</span></code></pre></div></td></tr></tbody></table></div>
</details>
</li>
</ul>
<h4 id="create-grafana-dashboards">Create Grafana dashboards</h4>
<p>Once the data source is connected, ready-made Grafana dashboards can be imported
directly by ID into the existing Grafana instance.</p>
<ul>
<li><a href="https://grafana.com/grafana/dashboards/21398-trivy-operator-dashboard/">Trivy Operator Dashboard (ID: 21398)</a>
    <a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../../../media/2025-12-21-monitoring-a-kubernetes-cluster-for-vulnerabilities/trivy-operator-grafana-dashboard.png" data-desc-position="bottom"><img alt="Grafana Trivy Operator Dashboard" src="../../../../media/2025-12-21-monitoring-a-kubernetes-cluster-for-vulnerabilities/trivy-operator-grafana-dashboard.png"></a></li>
<li><a href="https://grafana.com/grafana/dashboards/16337-trivy-operator-vulnerabilities/">Trivy Operator - Vulnerabilities (ID: 16337)</a>
    <a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../../../media/2025-12-21-monitoring-a-kubernetes-cluster-for-vulnerabilities/trivy-operator-grafana-vulnerabilities.png" data-desc-position="bottom"><img alt="Grafana Trivy Operator - Vulnerabilities" src="../../../../media/2025-12-21-monitoring-a-kubernetes-cluster-for-vulnerabilities/trivy-operator-grafana-vulnerabilities.png"></a></li>
</ul>
<h2 id="automated-monitoring-of-releases">Automated monitoring of releases</h2>
<p>While automatically <strong>updating</strong> all deployments to the latest stable version of every
Docker image may not be the best idea, at least <strong>monitoring</strong> the availability of new
releases should be automated. Considering a small homelab server has accumulated <strong>50</strong>
<em>running</em> containers in about three years, manually monitoring for new releases is
already a bit much:</p>
<details>
<summary>List of running Docker images as reported by <code>kubectl get pods</code></summary>
<div class="language-console highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="gp">$ </span>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-A<span class="w"> </span>-o<span class="w"> </span><span class="nv">jsonpath</span><span class="o">=</span><span class="s2">"{.items[*].spec.containers[*].image}"</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="w">    </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span>-s<span class="w"> </span><span class="s1">'[[:space:]]'</span><span class="w"> </span><span class="s1">'\n'</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-u
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="go">codercom/code-server</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="go">debian</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="go">deluan/navidrome:latest</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="go">docker.io/grafana/grafana:12.3.1</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="go">docker.io/influxdb:1.11.8</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="go">docker.io/kubernetesui/dashboard-api:1.12.0</span>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="go">docker.io/kubernetesui/dashboard-auth:1.2.4</span>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="go">docker.io/kubernetesui/dashboard-metrics-scraper:1.2.2</span>
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="go">docker.io/kubernetesui/dashboard-web:1.6.2</span>
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="go">docker.io/mongo:8.0.0</span>
</span><span id="__span-22-13"><a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a><span class="go">docker.io/pomerium/verify</span>
</span><span id="__span-22-14"><a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a><span class="go">fireflyiii/core</span>
</span><span id="__span-22-15"><a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a><span class="go">ghcr.io/advplyr/audiobookshelf:latest</span>
</span><span id="__span-22-16"><a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a><span class="go">ghcr.io/flannel-io/flannel:v0.26.7</span>
</span><span id="__span-22-17"><a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a><span class="go">ghcr.io/home-assistant/home-assistant:stable</span>
</span><span id="__span-22-18"><a id="__codelineno-22-18" name="__codelineno-22-18" href="#__codelineno-22-18"></a><span class="go">ghcr.io/ignisda/ryot:v10</span>
</span><span id="__span-22-19"><a id="__codelineno-22-19" name="__codelineno-22-19" href="#__codelineno-22-19"></a><span class="go">ghcr.io/raoulx24/trivy-operator-dashboard:1.7.1</span>
</span><span id="__span-22-20"><a id="__codelineno-22-20" name="__codelineno-22-20" href="#__codelineno-22-20"></a><span class="go">gotson/komga</span>
</span><span id="__span-22-21"><a id="__codelineno-22-21" name="__codelineno-22-21" href="#__codelineno-22-21"></a><span class="go">intel/intel-deviceplugin-operator:0.32.0</span>
</span><span id="__span-22-22"><a id="__codelineno-22-22" name="__codelineno-22-22" href="#__codelineno-22-22"></a><span class="go">intel/intel-gpu-plugin:0.32.0</span>
</span><span id="__span-22-23"><a id="__codelineno-22-23" name="__codelineno-22-23" href="#__codelineno-22-23"></a><span class="go">jellyfin/jellyfin</span>
</span><span id="__span-22-24"><a id="__codelineno-22-24" name="__codelineno-22-24" href="#__codelineno-22-24"></a><span class="go">kong:3.8</span>
</span><span id="__span-22-25"><a id="__codelineno-22-25" name="__codelineno-22-25" href="#__codelineno-22-25"></a><span class="go">lscr.io/linuxserver/unifi-network-application:10.0.162</span>
</span><span id="__span-22-26"><a id="__codelineno-22-26" name="__codelineno-22-26" href="#__codelineno-22-26"></a><span class="go">mirror.gcr.io/aquasec/trivy-operator:0.29.0</span>
</span><span id="__span-22-27"><a id="__codelineno-22-27" name="__codelineno-22-27" href="#__codelineno-22-27"></a><span class="go">pomerium/ingress-controller:main</span>
</span><span id="__span-22-28"><a id="__codelineno-22-28" name="__codelineno-22-28" href="#__codelineno-22-28"></a><span class="go">postgres:16-alpine</span>
</span><span id="__span-22-29"><a id="__codelineno-22-29" name="__codelineno-22-29" href="#__codelineno-22-29"></a><span class="go">qmcgaw/ddns-updater:latest</span>
</span><span id="__span-22-30"><a id="__codelineno-22-30" name="__codelineno-22-30" href="#__codelineno-22-30"></a><span class="go">quay.io/jetstack/cert-manager-cainjector:v1.17.2</span>
</span><span id="__span-22-31"><a id="__codelineno-22-31" name="__codelineno-22-31" href="#__codelineno-22-31"></a><span class="go">quay.io/jetstack/cert-manager-controller:v1.17.2</span>
</span><span id="__span-22-32"><a id="__codelineno-22-32" name="__codelineno-22-32" href="#__codelineno-22-32"></a><span class="go">quay.io/jetstack/cert-manager-webhook:v1.17.2</span>
</span><span id="__span-22-33"><a id="__codelineno-22-33" name="__codelineno-22-33" href="#__codelineno-22-33"></a><span class="go">quay.io/jetstack/version-checker:v0.10.0</span>
</span><span id="__span-22-34"><a id="__codelineno-22-34" name="__codelineno-22-34" href="#__codelineno-22-34"></a><span class="go">quay.io/metallb/controller:v0.14.9</span>
</span><span id="__span-22-35"><a id="__codelineno-22-35" name="__codelineno-22-35" href="#__codelineno-22-35"></a><span class="go">quay.io/metallb/speaker:v0.14.9</span>
</span><span id="__span-22-36"><a id="__codelineno-22-36" name="__codelineno-22-36" href="#__codelineno-22-36"></a><span class="go">quay.io/prometheus/alertmanager:v0.30.0</span>
</span><span id="__span-22-37"><a id="__codelineno-22-37" name="__codelineno-22-37" href="#__codelineno-22-37"></a><span class="go">quay.io/prometheus/node-exporter:v1.10.2</span>
</span><span id="__span-22-38"><a id="__codelineno-22-38" name="__codelineno-22-38" href="#__codelineno-22-38"></a><span class="go">quay.io/prometheus-operator/prometheus-config-reloader:v0.87.1</span>
</span><span id="__span-22-39"><a id="__codelineno-22-39" name="__codelineno-22-39" href="#__codelineno-22-39"></a><span class="go">quay.io/prometheus-operator/prometheus-operator:v0.87.1</span>
</span><span id="__span-22-40"><a id="__codelineno-22-40" name="__codelineno-22-40" href="#__codelineno-22-40"></a><span class="go">quay.io/prometheus/prometheus:v3.8.1</span>
</span><span id="__span-22-41"><a id="__codelineno-22-41" name="__codelineno-22-41" href="#__codelineno-22-41"></a><span class="go">registry.k8s.io/coredns/coredns:v1.11.3</span>
</span><span id="__span-22-42"><a id="__codelineno-22-42" name="__codelineno-22-42" href="#__codelineno-22-42"></a><span class="go">registry.k8s.io/etcd:3.5.16-0</span>
</span><span id="__span-22-43"><a id="__codelineno-22-43" name="__codelineno-22-43" href="#__codelineno-22-43"></a><span class="go">registry.k8s.io/ingress-nginx/controller:v1.12.1@sha256:d2fbc4ec70d8aa2050dd91a91506e998765e86c96f32cffb56c503c9c34eed5b</span>
</span><span id="__span-22-44"><a id="__codelineno-22-44" name="__codelineno-22-44" href="#__codelineno-22-44"></a><span class="go">registry.k8s.io/kube-apiserver:v1.32.4</span>
</span><span id="__span-22-45"><a id="__codelineno-22-45" name="__codelineno-22-45" href="#__codelineno-22-45"></a><span class="go">registry.k8s.io/kube-controller-manager:v1.32.4</span>
</span><span id="__span-22-46"><a id="__codelineno-22-46" name="__codelineno-22-46" href="#__codelineno-22-46"></a><span class="go">registry.k8s.io/kube-proxy:v1.32.4</span>
</span><span id="__span-22-47"><a id="__codelineno-22-47" name="__codelineno-22-47" href="#__codelineno-22-47"></a><span class="go">registry.k8s.io/kube-scheduler:v1.32.4</span>
</span><span id="__span-22-48"><a id="__codelineno-22-48" name="__codelineno-22-48" href="#__codelineno-22-48"></a><span class="go">registry.k8s.io/kube-state-metrics/kube-state-metrics:v2.17.0</span>
</span><span id="__span-22-49"><a id="__codelineno-22-49" name="__codelineno-22-49" href="#__codelineno-22-49"></a><span class="go">registry.k8s.io/nfd/node-feature-discovery:v0.17.3</span>
</span><span id="__span-22-50"><a id="__codelineno-22-50" name="__codelineno-22-50" href="#__codelineno-22-50"></a><span class="go">tailscale/k8s-operator:v1.82.0</span>
</span><span id="__span-22-51"><a id="__codelineno-22-51" name="__codelineno-22-51" href="#__codelineno-22-51"></a><span class="go">tailscale/tailscale:v1.82.0</span>
</span><span id="__span-22-52"><a id="__codelineno-22-52" name="__codelineno-22-52" href="#__codelineno-22-52"></a><span class="go">yobasystems/alpine-mariadb:latest</span>
</span></code></pre></div>
</details>
<h3 id="jetstack-version-checker">Jetstack Version-Checker</h3>
<p><a href="https://github.com/jetstack/version-checker?tab=readme-ov-file#version-checker">Jetstack Version-Checker</a>
is a Kubernetes utility for observing the current versions of images running in the
cluster, as well as the latest available upstream. Additionally, it monitors the
Kubernetes cluster version against the latest available releases using official
Kubernetes release channels. These checks get exposed as Prometheus metrics to be
viewed on a dashboard.</p>
<p><a href="https://github.com/jetstack/version-checker/blob/main/docs/installation.md#install-using-helm">Install using Helm</a>
with the following <code>version-checker-values.yaml</code> to disable Grafana, because it's
already running as part of
<a href="../../../../2024/04/20/monitoring-with-influxdb-and-grafana-on-kubernetes/">monitoring with InfluxDB and Grafana</a>,
and enable the service metrics endpoint for Prometheous to scrape metrics:</p>
<div class="language-yaml highlight"><span class="filename">prometheus/version-checker-values.yaml</span><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="c1"># Disable Grafana installation</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="nt">dashboards</span><span class="p">:</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="w">  </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="c1"># Enable the ServiceMonitors for Prometheus to scrape metrics.</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="nt">serviceMonitor</span><span class="p">:</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="w">  </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span></code></pre></div>
<p>Add the Jetstack Helm repository and install the chart in the <code>monitoring</code> namespace:</p>
<div class="language-console highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="gp">$ </span>helm<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>jetstack<span class="w"> </span>https://charts.jetstack.io
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="go">"jetstack" already exists with the same configuration, skipping</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="gp">$ </span>helm<span class="w"> </span>upgrade<span class="w"> </span>--install<span class="w"> </span>version-checker<span class="w"> </span>jetstack/version-checker<span class="w"> </span><span class="se">\</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="w">  </span>--namespace<span class="w"> </span>monitoring<span class="w"> </span><span class="se">\</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="w">  </span>--values<span class="w"> </span>prometheus/version-checker-values.yaml
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="go">Release "version-checker" does not exist. Installing it now.</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="go">NAME: version-checker</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="go">LAST DEPLOYED: Sun Dec 21 17:08:15 2025</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="go">NAMESPACE: monitoring</span>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="go">STATUS: deployed</span>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="go">REVISION: 1</span>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a><span class="go">TEST SUITE: None</span>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a>
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a><span class="gp">$ </span>kubectl<span class="w"> </span>describe<span class="w"> </span>servicemonitor<span class="w"> </span>version-checker<span class="w"> </span>-n<span class="w"> </span>monitoring<span class="w"> </span>
</span><span id="__span-24-16"><a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a><span class="go">Name:         version-checker</span>
</span><span id="__span-24-17"><a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a><span class="go">Namespace:    monitoring</span>
</span><span id="__span-24-18"><a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a><span class="go">Labels:       app=version-checker</span>
</span><span id="__span-24-19"><a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a><span class="go">              app.kubernetes.io/managed-by=Helm</span>
</span><span id="__span-24-20"><a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a><span class="go">Annotations:  meta.helm.sh/release-name: version-checker</span>
</span><span id="__span-24-21"><a id="__codelineno-24-21" name="__codelineno-24-21" href="#__codelineno-24-21"></a><span class="go">              meta.helm.sh/release-namespace: monitoring</span>
</span><span id="__span-24-22"><a id="__codelineno-24-22" name="__codelineno-24-22" href="#__codelineno-24-22"></a><span class="go">API Version:  monitoring.coreos.com/v1</span>
</span><span id="__span-24-23"><a id="__codelineno-24-23" name="__codelineno-24-23" href="#__codelineno-24-23"></a><span class="go">Kind:         ServiceMonitor</span>
</span><span id="__span-24-24"><a id="__codelineno-24-24" name="__codelineno-24-24" href="#__codelineno-24-24"></a><span class="go">Metadata:</span>
</span><span id="__span-24-25"><a id="__codelineno-24-25" name="__codelineno-24-25" href="#__codelineno-24-25"></a><span class="go">  Creation Timestamp:  2025-12-21T16:08:18Z</span>
</span><span id="__span-24-26"><a id="__codelineno-24-26" name="__codelineno-24-26" href="#__codelineno-24-26"></a><span class="go">  Generation:          1</span>
</span><span id="__span-24-27"><a id="__codelineno-24-27" name="__codelineno-24-27" href="#__codelineno-24-27"></a><span class="go">  Resource Version:    52349035</span>
</span><span id="__span-24-28"><a id="__codelineno-24-28" name="__codelineno-24-28" href="#__codelineno-24-28"></a><span class="go">  UID:                 37dc3c0f-9bdd-4271-9ee5-810f53e3f3cb</span>
</span><span id="__span-24-29"><a id="__codelineno-24-29" name="__codelineno-24-29" href="#__codelineno-24-29"></a><span class="go">Spec:</span>
</span><span id="__span-24-30"><a id="__codelineno-24-30" name="__codelineno-24-30" href="#__codelineno-24-30"></a><span class="go">  Endpoints:</span>
</span><span id="__span-24-31"><a id="__codelineno-24-31" name="__codelineno-24-31" href="#__codelineno-24-31"></a><span class="go">    Path:  /metrics</span>
</span><span id="__span-24-32"><a id="__codelineno-24-32" name="__codelineno-24-32" href="#__codelineno-24-32"></a><span class="go">    Port:  web</span>
</span><span id="__span-24-33"><a id="__codelineno-24-33" name="__codelineno-24-33" href="#__codelineno-24-33"></a><span class="go">  Selector:</span>
</span><span id="__span-24-34"><a id="__codelineno-24-34" name="__codelineno-24-34" href="#__codelineno-24-34"></a><span class="go">    Match Labels:</span>
</span><span id="__span-24-35"><a id="__codelineno-24-35" name="__codelineno-24-35" href="#__codelineno-24-35"></a><span class="go">      App:  version-checker</span>
</span><span id="__span-24-36"><a id="__codelineno-24-36" name="__codelineno-24-36" href="#__codelineno-24-36"></a><span class="go">Events:     &lt;none&gt;</span>
</span></code></pre></div>
<p>Once Version-Checker is running, with its <code>ServiceMonitor</code> exposing metrics, there is
(at least one) easy-to-install Grafana dashboard to conveniently display and explore
these metrics:
<a href="https://grafana.com/grafana/dashboards/22745-version-checker/">Version-Checker (ID: 22745)</a>
is the most current and recommended version-checker dashboard;
it provides a clean table view of current image versions vs.latest upstream releases:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../../../media/2025-12-21-monitoring-a-kubernetes-cluster-for-vulnerabilities/version-checker-dashboard.png" data-desc-position="bottom"><img alt="Grafana Version-Checker dashboard" src="../../../../media/2025-12-21-monitoring-a-kubernetes-cluster-for-vulnerabilities/version-checker-dashboard.png"></a></p>
<p><a href="https://github.com/jetstack/version-checker/blob/main/docs/installation.md#supported-annotations">Supported Annotations</a>
are needed to make <code>version-checker</code>  match only specific version numbers, so that
the "Latest Version" is picked among semantic version tags rather than versions that
should not be running in production (<code>experimental</code>, <code>develop</code>, <code>unstable</code>, etc),
in some cases even pinning to a specific major version other than the latest:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="nt">metadata</span><span class="p">:</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unifi</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unifi</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="nt">spec</span><span class="p">:</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="w">  </span><span class="nt">template</span><span class="p">:</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="hll"><span class="w">      </span><span class="nt">annotations</span><span class="p">:</span>
</span></span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="hll"><span class="w">        </span><span class="nt">enable.version-checker.io/unifi</span><span class="p">:</span><span class="w"> </span><span class="s">"true"</span>
</span></span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="hll"><span class="w">        </span><span class="nt">match-regex.version-checker.io/unifi</span><span class="p">:</span><span class="w"> </span><span class="s">"^v?\\d+\\.\\d+\\.\\d+$"</span>
</span></span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a><span class="hll"><span class="w">        </span><span class="nt">pin-major.version-checker.io/mongo</span><span class="p">:</span><span class="w"> </span><span class="s">"10"</span>
</span></span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a><span class="hll"><span class="w">        </span><span class="nt">pin-minor.version-checker.io/mongo</span><span class="p">:</span><span class="w"> </span><span class="s">"0"</span>
</span></span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a><span class="hll"><span class="w">        </span><span class="nt">resolve-sha-to-tags.version-checker.io/unifi</span><span class="p">:</span><span class="w"> </span><span class="s">"true"</span>
</span></span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a><span class="hll"><span class="w">        </span><span class="nt">use-metadata.version-checker.io/unifi</span><span class="p">:</span><span class="w"> </span><span class="s">"false"</span>
</span></span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a><span class="hll"><span class="w">        </span><span class="nt">use-sha.version-checker.io/unifi</span><span class="p">:</span><span class="w"> </span><span class="s">"false"</span>
</span></span><span id="__span-25-17"><a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a><span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
</span><span id="__span-25-18"><a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a><span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unifi</span>
</span><span id="__span-25-19"><a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a><span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
</span><span id="__span-25-20"><a id="__codelineno-25-20" name="__codelineno-25-20" href="#__codelineno-25-20"></a><span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
</span><span id="__span-25-21"><a id="__codelineno-25-21" name="__codelineno-25-21" href="#__codelineno-25-21"></a><span class="hll"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lscr.io/linuxserver/unifi-network-application:10.0.162</span>
</span></span></code></pre></div>
<h2 id="appendix-install-krew-and-tree">Appendix: install <code>krew</code> and <code>tree</code></h2>
<p><a href="https://krew.sigs.k8s.io/docs/user-guide/setup/install/#bash">Install <code>krew</code> from Bash</a>,
append <code>export PATH="${KREW_ROOT:-$HOME/.krew}/bin:$PATH"</code> to the <code>.bashrc</code> and reload it
with <code>. .bashrc</code> to have <code>krew</code> installed and ready to use:</p>
<div class="language-console highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>/tmp<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">(</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="go">  set -x; cd "$(mktemp -d)" &amp;&amp;</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="go">  OS="$(uname | tr '[:upper:]' '[:lower:]')" &amp;&amp;</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="go">  ARCH="$(uname -m | sed -e 's/x86_64/amd64/' -e 's/\(arm\)\(64\)\?.*/\1\2/' -e 's/aarch64$/arm64/')" &amp;&amp;</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="go">  KREW="krew-${OS}_${ARCH}" &amp;&amp;</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="go">  curl -fsSLO "https://github.com/kubernetes-sigs/krew/releases/latest/download/${KREW}.tar.gz" &amp;&amp;</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="go">  tar zxvf "${KREW}.tar.gz" &amp;&amp;</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="go">  ./"${KREW}" install krew</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="go">)</span>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a><span class="go">++ mktemp -d</span>
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a><span class="go">+ cd /tmp/tmp.e0UDytiaZ9</span>
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a><span class="go">++ uname</span>
</span><span id="__span-26-13"><a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a><span class="go">++ tr '[:upper:]' '[:lower:]'</span>
</span><span id="__span-26-14"><a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a><span class="go">+ OS=linux</span>
</span><span id="__span-26-15"><a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a><span class="go">++ uname -m</span>
</span><span id="__span-26-16"><a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a><span class="go">++ sed -e s/x86_64/amd64/ -e 's/\(arm\)\(64\)\?.*/\1\2/' -e 's/aarch64$/arm64/'</span>
</span><span id="__span-26-17"><a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a><span class="go">+ ARCH=amd64</span>
</span><span id="__span-26-18"><a id="__codelineno-26-18" name="__codelineno-26-18" href="#__codelineno-26-18"></a><span class="go">+ KREW=krew-linux_amd64</span>
</span><span id="__span-26-19"><a id="__codelineno-26-19" name="__codelineno-26-19" href="#__codelineno-26-19"></a><span class="go">+ curl -fsSLO https://github.com/kubernetes-sigs/krew/releases/latest/download/krew-linux_amd64.tar.gz</span>
</span><span id="__span-26-20"><a id="__codelineno-26-20" name="__codelineno-26-20" href="#__codelineno-26-20"></a><span class="go">+ tar zxvf krew-linux_amd64.tar.gz</span>
</span><span id="__span-26-21"><a id="__codelineno-26-21" name="__codelineno-26-21" href="#__codelineno-26-21"></a><span class="go">./._LICENSE</span>
</span><span id="__span-26-22"><a id="__codelineno-26-22" name="__codelineno-26-22" href="#__codelineno-26-22"></a><span class="go">tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'</span>
</span><span id="__span-26-23"><a id="__codelineno-26-23" name="__codelineno-26-23" href="#__codelineno-26-23"></a><span class="go">./LICENSE</span>
</span><span id="__span-26-24"><a id="__codelineno-26-24" name="__codelineno-26-24" href="#__codelineno-26-24"></a><span class="go">./._krew-linux_amd64</span>
</span><span id="__span-26-25"><a id="__codelineno-26-25" name="__codelineno-26-25" href="#__codelineno-26-25"></a><span class="go">tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'</span>
</span><span id="__span-26-26"><a id="__codelineno-26-26" name="__codelineno-26-26" href="#__codelineno-26-26"></a><span class="go">./krew-linux_amd64</span>
</span><span id="__span-26-27"><a id="__codelineno-26-27" name="__codelineno-26-27" href="#__codelineno-26-27"></a><span class="go">+ ./krew-linux_amd64 install krew</span>
</span><span id="__span-26-28"><a id="__codelineno-26-28" name="__codelineno-26-28" href="#__codelineno-26-28"></a><span class="go">Adding "default" plugin index from https://github.com/kubernetes-sigs/krew-index.git.</span>
</span><span id="__span-26-29"><a id="__codelineno-26-29" name="__codelineno-26-29" href="#__codelineno-26-29"></a><span class="go">Updated the local copy of plugin index.</span>
</span><span id="__span-26-30"><a id="__codelineno-26-30" name="__codelineno-26-30" href="#__codelineno-26-30"></a><span class="go">Installing plugin: krew</span>
</span><span id="__span-26-31"><a id="__codelineno-26-31" name="__codelineno-26-31" href="#__codelineno-26-31"></a><span class="go">Installed plugin: krew</span>
</span><span id="__span-26-32"><a id="__codelineno-26-32" name="__codelineno-26-32" href="#__codelineno-26-32"></a><span class="go">\</span>
</span><span id="__span-26-33"><a id="__codelineno-26-33" name="__codelineno-26-33" href="#__codelineno-26-33"></a><span class="go"> | Use this plugin:</span>
</span><span id="__span-26-34"><a id="__codelineno-26-34" name="__codelineno-26-34" href="#__codelineno-26-34"></a><span class="go"> |      kubectl krew</span>
</span><span id="__span-26-35"><a id="__codelineno-26-35" name="__codelineno-26-35" href="#__codelineno-26-35"></a><span class="go"> | Documentation:</span>
</span><span id="__span-26-36"><a id="__codelineno-26-36" name="__codelineno-26-36" href="#__codelineno-26-36"></a><span class="go"> |      https://krew.sigs.k8s.io/</span>
</span><span id="__span-26-37"><a id="__codelineno-26-37" name="__codelineno-26-37" href="#__codelineno-26-37"></a><span class="go"> | Caveats:</span>
</span><span id="__span-26-38"><a id="__codelineno-26-38" name="__codelineno-26-38" href="#__codelineno-26-38"></a><span class="go"> | \</span>
</span><span id="__span-26-39"><a id="__codelineno-26-39" name="__codelineno-26-39" href="#__codelineno-26-39"></a><span class="go"> |  | krew is now installed! To start using kubectl plugins, you need to add</span>
</span><span id="__span-26-40"><a id="__codelineno-26-40" name="__codelineno-26-40" href="#__codelineno-26-40"></a><span class="go"> |  | krew's installation directory to your PATH:</span>
</span><span id="__span-26-41"><a id="__codelineno-26-41" name="__codelineno-26-41" href="#__codelineno-26-41"></a><span class="go"> |  | </span>
</span><span id="__span-26-42"><a id="__codelineno-26-42" name="__codelineno-26-42" href="#__codelineno-26-42"></a><span class="go"> |  |   * macOS/Linux:</span>
</span><span id="__span-26-43"><a id="__codelineno-26-43" name="__codelineno-26-43" href="#__codelineno-26-43"></a><span class="go"> |  |     - Add the following to your ~/.bashrc or ~/.zshrc:</span>
</span><span id="__span-26-44"><a id="__codelineno-26-44" name="__codelineno-26-44" href="#__codelineno-26-44"></a><span class="go"> |  |         export PATH="${KREW_ROOT:-$HOME/.krew}/bin:$PATH"</span>
</span><span id="__span-26-45"><a id="__codelineno-26-45" name="__codelineno-26-45" href="#__codelineno-26-45"></a><span class="go"> |  |     - Restart your shell.</span>
</span><span id="__span-26-46"><a id="__codelineno-26-46" name="__codelineno-26-46" href="#__codelineno-26-46"></a><span class="go"> |  | </span>
</span><span id="__span-26-47"><a id="__codelineno-26-47" name="__codelineno-26-47" href="#__codelineno-26-47"></a><span class="go"> |  |   * Windows: Add %USERPROFILE%\.krew\bin to your PATH environment variable</span>
</span><span id="__span-26-48"><a id="__codelineno-26-48" name="__codelineno-26-48" href="#__codelineno-26-48"></a><span class="go"> |  | </span>
</span><span id="__span-26-49"><a id="__codelineno-26-49" name="__codelineno-26-49" href="#__codelineno-26-49"></a><span class="go"> |  | To list krew commands and to get help, run:</span>
</span><span id="__span-26-50"><a id="__codelineno-26-50" name="__codelineno-26-50" href="#__codelineno-26-50"></a><span class="go"> |  |   $ kubectl krew</span>
</span><span id="__span-26-51"><a id="__codelineno-26-51" name="__codelineno-26-51" href="#__codelineno-26-51"></a><span class="go"> |  | For a full list of available plugins, run:</span>
</span><span id="__span-26-52"><a id="__codelineno-26-52" name="__codelineno-26-52" href="#__codelineno-26-52"></a><span class="go"> |  |   $ kubectl krew search</span>
</span><span id="__span-26-53"><a id="__codelineno-26-53" name="__codelineno-26-53" href="#__codelineno-26-53"></a><span class="go"> |  | </span>
</span><span id="__span-26-54"><a id="__codelineno-26-54" name="__codelineno-26-54" href="#__codelineno-26-54"></a><span class="go"> |  | You can find documentation at</span>
</span><span id="__span-26-55"><a id="__codelineno-26-55" name="__codelineno-26-55" href="#__codelineno-26-55"></a><span class="go"> |  |   https://krew.sigs.k8s.io/docs/user-guide/quickstart/.</span>
</span><span id="__span-26-56"><a id="__codelineno-26-56" name="__codelineno-26-56" href="#__codelineno-26-56"></a><span class="go"> | /</span>
</span><span id="__span-26-57"><a id="__codelineno-26-57" name="__codelineno-26-57" href="#__codelineno-26-57"></a><span class="go">/</span>
</span><span id="__span-26-58"><a id="__codelineno-26-58" name="__codelineno-26-58" href="#__codelineno-26-58"></a>
</span><span id="__span-26-59"><a id="__codelineno-26-59" name="__codelineno-26-59" href="#__codelineno-26-59"></a><span class="gp">$ </span><span class="nb">echo</span><span class="w"> </span><span class="s1">'export PATH="${KREW_ROOT:-$HOME/.krew}/bin:$PATH"'</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.bashrc
</span><span id="__span-26-60"><a id="__codelineno-26-60" name="__codelineno-26-60" href="#__codelineno-26-60"></a><span class="gp">$ </span>.<span class="w"> </span>.bashrc
</span></code></pre></div>
<p>Then use <code>krew</code> to isntall
<a href="https://github.com/ahmetb/kubectl-tree?tab=readme-ov-file#kubectl-tree"><code>kubectl tree</code></a></p>
<div class="language-console highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="gp">$ </span>kubectl<span class="w"> </span>krew<span class="w"> </span>update
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="go">Updated the local copy of plugin index.</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="gp">$ </span>kubectl<span class="w"> </span>krew<span class="w"> </span>install<span class="w"> </span>tree
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="go">Updated the local copy of plugin index.</span>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="go">Installing plugin: tree</span>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="go">Installed plugin: tree</span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="go">\</span>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="go"> | Use this plugin:</span>
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="go"> |      kubectl tree</span>
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a><span class="go"> | Documentation:</span>
</span><span id="__span-27-12"><a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a><span class="go"> |      https://github.com/ahmetb/kubectl-tree</span>
</span><span id="__span-27-13"><a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a><span class="go"> | Caveats:</span>
</span><span id="__span-27-14"><a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a><span class="go"> | \</span>
</span><span id="__span-27-15"><a id="__codelineno-27-15" name="__codelineno-27-15" href="#__codelineno-27-15"></a><span class="go"> |  | krew is now installed! To start using kubectl plugins, you need to add</span>
</span><span id="__span-27-16"><a id="__codelineno-27-16" name="__codelineno-27-16" href="#__codelineno-27-16"></a><span class="go"> |  | krew's installation directory to your PATH:</span>
</span><span id="__span-27-17"><a id="__codelineno-27-17" name="__codelineno-27-17" href="#__codelineno-27-17"></a><span class="go"> |  | </span>
</span><span id="__span-27-18"><a id="__codelineno-27-18" name="__codelineno-27-18" href="#__codelineno-27-18"></a><span class="go"> |  |   * macOS/Linux:</span>
</span><span id="__span-27-19"><a id="__codelineno-27-19" name="__codelineno-27-19" href="#__codelineno-27-19"></a><span class="go"> |  |     - Add the following to your ~/.bashrc or ~/.zshrc:</span>
</span><span id="__span-27-20"><a id="__codelineno-27-20" name="__codelineno-27-20" href="#__codelineno-27-20"></a><span class="go"> |  |         export PATH="${KREW_ROOT:-$HOME/.krew}/bin:$PATH"</span>
</span><span id="__span-27-21"><a id="__codelineno-27-21" name="__codelineno-27-21" href="#__codelineno-27-21"></a><span class="go"> |  |     - Restart your shell.</span>
</span><span id="__span-27-22"><a id="__codelineno-27-22" name="__codelineno-27-22" href="#__codelineno-27-22"></a><span class="go"> |  | </span>
</span><span id="__span-27-23"><a id="__codelineno-27-23" name="__codelineno-27-23" href="#__codelineno-27-23"></a><span class="go"> |  |   * Windows: Add %USERPROFILE%\.krew\bin to your PATH environment variable</span>
</span><span id="__span-27-24"><a id="__codelineno-27-24" name="__codelineno-27-24" href="#__codelineno-27-24"></a><span class="go"> |  | </span>
</span><span id="__span-27-25"><a id="__codelineno-27-25" name="__codelineno-27-25" href="#__codelineno-27-25"></a><span class="go"> |  | To list krew commands and to get help, run:</span>
</span><span id="__span-27-26"><a id="__codelineno-27-26" name="__codelineno-27-26" href="#__codelineno-27-26"></a><span class="go"> |  |   $ kubectl krew</span>
</span><span id="__span-27-27"><a id="__codelineno-27-27" name="__codelineno-27-27" href="#__codelineno-27-27"></a><span class="go"> |  | For a full list of available plugins, run:</span>
</span><span id="__span-27-28"><a id="__codelineno-27-28" name="__codelineno-27-28" href="#__codelineno-27-28"></a><span class="go"> |  |   $ kubectl krew search</span>
</span><span id="__span-27-29"><a id="__codelineno-27-29" name="__codelineno-27-29" href="#__codelineno-27-29"></a><span class="go"> |  | </span>
</span><span id="__span-27-30"><a id="__codelineno-27-30" name="__codelineno-27-30" href="#__codelineno-27-30"></a><span class="go"> |  | You can find documentation at</span>
</span><span id="__span-27-31"><a id="__codelineno-27-31" name="__codelineno-27-31" href="#__codelineno-27-31"></a><span class="go"> |  |   https://krew.sigs.k8s.io/docs/user-guide/quickstart/.</span>
</span><span id="__span-27-32"><a id="__codelineno-27-32" name="__codelineno-27-32" href="#__codelineno-27-32"></a><span class="go"> | /</span>
</span><span id="__span-27-33"><a id="__codelineno-27-33" name="__codelineno-27-33" href="#__codelineno-27-33"></a><span class="go">/</span>
</span></code></pre></div>
<p>Use the <code>kubectl tree</code> command on deployments to more easily find whether they are ready:</p>
<div class="language-console highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="gp">$ </span>kubectl<span class="w"> </span>tree<span class="w"> </span>deployment<span class="w"> </span>unifi<span class="w"> </span>-n<span class="w"> </span>unifi
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="go">NAMESPACE  NAME                            READY  REASON  STATUS   AGE </span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="go">unifi      Deployment/unifi                -              -        233d</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="go">unifi      ├─ReplicaSet/unifi-584f4847c7   -              -        233d</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="go">unifi      ├─ReplicaSet/unifi-7d44b599dc   -              -        94d </span>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="go">unifi      │ └─Pod/unifi-7d44b599dc-58z92  True           Current  94d </span>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="go">unifi      ├─ReplicaSet/unifi-8997b8865    -              -        199d</span>
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="go">unifi      └─ReplicaSet/unifi-bff88d4df    -              -        95d </span>
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a>
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a><span class="gp">$ </span>kubectl<span class="w"> </span>tree<span class="w"> </span>deployment<span class="w"> </span>home-assistant<span class="w"> </span>-n<span class="w"> </span>home-assistant
</span><span id="__span-28-11"><a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a><span class="go">NAMESPACE       NAME                                     READY  REASON  STATUS   AGE </span>
</span><span id="__span-28-12"><a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a><span class="go">home-assistant  Deployment/home-assistant                -              -        237d</span>
</span><span id="__span-28-13"><a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a><span class="go">home-assistant  └─ReplicaSet/home-assistant-77bf44c47b   -              -        237d</span>
</span><span id="__span-28-14"><a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a><span class="go">home-assistant    └─Pod/home-assistant-77bf44c47b-trgrt  True           Current  141d</span>
</span></code></pre></div>
<h2 id="appendix-kube-bench">Appendix: <code>kube-bench</code></h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>$ wget https://github.com/aquasecurity/kube-bench/releases/download/v0.14.0/kube-bench_0.14.0_linux_amd64.deb
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>$ sudo dpkg -i ./kube-bench_0.14.0_linux_amd64.deb 
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>$ sudo kube-bench run 
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>[INFO] 1 Control Plane Security Configuration
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>[INFO] 1.1 Control Plane Node Configuration Files
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a>[PASS] 1.1.1 Ensure that the API server pod specification file permissions are set to 600 or more restrictive (Automated)
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a>[PASS] 1.1.2 Ensure that the API server pod specification file ownership is set to root:root (Automated)
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a>[PASS] 1.1.3 Ensure that the controller manager pod specification file permissions are set to 600 or more restrictive (Automated)
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a>[PASS] 1.1.4 Ensure that the controller manager pod specification file ownership is set to root:root (Automated)
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a>[PASS] 1.1.5 Ensure that the scheduler pod specification file permissions are set to 600 or more restrictive (Automated)
</span><span id="__span-29-13"><a id="__codelineno-29-13" name="__codelineno-29-13" href="#__codelineno-29-13"></a>[PASS] 1.1.6 Ensure that the scheduler pod specification file ownership is set to root:root (Automated)
</span><span id="__span-29-14"><a id="__codelineno-29-14" name="__codelineno-29-14" href="#__codelineno-29-14"></a>[PASS] 1.1.7 Ensure that the etcd pod specification file permissions are set to 600 or more restrictive (Automated)
</span><span id="__span-29-15"><a id="__codelineno-29-15" name="__codelineno-29-15" href="#__codelineno-29-15"></a>[PASS] 1.1.8 Ensure that the etcd pod specification file ownership is set to root:root (Automated)
</span><span id="__span-29-16"><a id="__codelineno-29-16" name="__codelineno-29-16" href="#__codelineno-29-16"></a>[WARN] 1.1.9 Ensure that the Container Network Interface file permissions are set to 600 or more restrictive (Manual)
</span><span id="__span-29-17"><a id="__codelineno-29-17" name="__codelineno-29-17" href="#__codelineno-29-17"></a>[PASS] 1.1.10 Ensure that the Container Network Interface file ownership is set to root:root (Manual)
</span><span id="__span-29-18"><a id="__codelineno-29-18" name="__codelineno-29-18" href="#__codelineno-29-18"></a>[PASS] 1.1.11 Ensure that the etcd data directory permissions are set to 700 or more restrictive (Automated)
</span><span id="__span-29-19"><a id="__codelineno-29-19" name="__codelineno-29-19" href="#__codelineno-29-19"></a>[FAIL] 1.1.12 Ensure that the etcd data directory ownership is set to etcd:etcd (Automated)
</span><span id="__span-29-20"><a id="__codelineno-29-20" name="__codelineno-29-20" href="#__codelineno-29-20"></a>[PASS] 1.1.13 Ensure that the default administrative credential file permissions are set to 600 (Automated)
</span><span id="__span-29-21"><a id="__codelineno-29-21" name="__codelineno-29-21" href="#__codelineno-29-21"></a>[PASS] 1.1.14 Ensure that the default administrative credential file ownership is set to root:root (Automated)
</span><span id="__span-29-22"><a id="__codelineno-29-22" name="__codelineno-29-22" href="#__codelineno-29-22"></a>[PASS] 1.1.15 Ensure that the scheduler.conf file permissions are set to 600 or more restrictive (Automated)
</span><span id="__span-29-23"><a id="__codelineno-29-23" name="__codelineno-29-23" href="#__codelineno-29-23"></a>[PASS] 1.1.16 Ensure that the scheduler.conf file ownership is set to root:root (Automated)
</span><span id="__span-29-24"><a id="__codelineno-29-24" name="__codelineno-29-24" href="#__codelineno-29-24"></a>[PASS] 1.1.17 Ensure that the controller-manager.conf file permissions are set to 600 or more restrictive (Automated)
</span><span id="__span-29-25"><a id="__codelineno-29-25" name="__codelineno-29-25" href="#__codelineno-29-25"></a>[PASS] 1.1.18 Ensure that the controller-manager.conf file ownership is set to root:root (Automated)
</span><span id="__span-29-26"><a id="__codelineno-29-26" name="__codelineno-29-26" href="#__codelineno-29-26"></a>[PASS] 1.1.19 Ensure that the Kubernetes PKI directory and file ownership is set to root:root (Automated)
</span><span id="__span-29-27"><a id="__codelineno-29-27" name="__codelineno-29-27" href="#__codelineno-29-27"></a>[PASS] 1.1.20 Ensure that the Kubernetes PKI certificate file permissions are set to 644 or more restrictive (Manual)
</span><span id="__span-29-28"><a id="__codelineno-29-28" name="__codelineno-29-28" href="#__codelineno-29-28"></a>[PASS] 1.1.21 Ensure that the Kubernetes PKI key file permissions are set to 600 (Manual)
</span><span id="__span-29-29"><a id="__codelineno-29-29" name="__codelineno-29-29" href="#__codelineno-29-29"></a>[INFO] 1.2 API Server
</span><span id="__span-29-30"><a id="__codelineno-29-30" name="__codelineno-29-30" href="#__codelineno-29-30"></a>[WARN] 1.2.1 Ensure that the --anonymous-auth argument is set to false (Manual)
</span><span id="__span-29-31"><a id="__codelineno-29-31" name="__codelineno-29-31" href="#__codelineno-29-31"></a>[PASS] 1.2.2 Ensure that the --token-auth-file parameter is not set (Automated)
</span><span id="__span-29-32"><a id="__codelineno-29-32" name="__codelineno-29-32" href="#__codelineno-29-32"></a>[WARN] 1.2.3 Ensure that the --DenyServiceExternalIPs is set (Manual)
</span><span id="__span-29-33"><a id="__codelineno-29-33" name="__codelineno-29-33" href="#__codelineno-29-33"></a>[PASS] 1.2.4 Ensure that the --kubelet-client-certificate and --kubelet-client-key arguments are set as appropriate (Automated)
</span><span id="__span-29-34"><a id="__codelineno-29-34" name="__codelineno-29-34" href="#__codelineno-29-34"></a>[FAIL] 1.2.5 Ensure that the --kubelet-certificate-authority argument is set as appropriate (Automated)
</span><span id="__span-29-35"><a id="__codelineno-29-35" name="__codelineno-29-35" href="#__codelineno-29-35"></a>[PASS] 1.2.6 Ensure that the --authorization-mode argument is not set to AlwaysAllow (Automated)
</span><span id="__span-29-36"><a id="__codelineno-29-36" name="__codelineno-29-36" href="#__codelineno-29-36"></a>[PASS] 1.2.7 Ensure that the --authorization-mode argument includes Node (Automated)
</span><span id="__span-29-37"><a id="__codelineno-29-37" name="__codelineno-29-37" href="#__codelineno-29-37"></a>[PASS] 1.2.8 Ensure that the --authorization-mode argument includes RBAC (Automated)
</span><span id="__span-29-38"><a id="__codelineno-29-38" name="__codelineno-29-38" href="#__codelineno-29-38"></a>[WARN] 1.2.9 Ensure that the admission control plugin EventRateLimit is set (Manual)
</span><span id="__span-29-39"><a id="__codelineno-29-39" name="__codelineno-29-39" href="#__codelineno-29-39"></a>[PASS] 1.2.10 Ensure that the admission control plugin AlwaysAdmit is not set (Automated)
</span><span id="__span-29-40"><a id="__codelineno-29-40" name="__codelineno-29-40" href="#__codelineno-29-40"></a>[WARN] 1.2.11 Ensure that the admission control plugin AlwaysPullImages is set (Manual)
</span><span id="__span-29-41"><a id="__codelineno-29-41" name="__codelineno-29-41" href="#__codelineno-29-41"></a>[PASS] 1.2.12 Ensure that the admission control plugin ServiceAccount is set (Automated)
</span><span id="__span-29-42"><a id="__codelineno-29-42" name="__codelineno-29-42" href="#__codelineno-29-42"></a>[PASS] 1.2.13 Ensure that the admission control plugin NamespaceLifecycle is set (Automated)
</span><span id="__span-29-43"><a id="__codelineno-29-43" name="__codelineno-29-43" href="#__codelineno-29-43"></a>[PASS] 1.2.14 Ensure that the admission control plugin NodeRestriction is set (Automated)
</span><span id="__span-29-44"><a id="__codelineno-29-44" name="__codelineno-29-44" href="#__codelineno-29-44"></a>[FAIL] 1.2.15 Ensure that the --profiling argument is set to false (Automated)
</span><span id="__span-29-45"><a id="__codelineno-29-45" name="__codelineno-29-45" href="#__codelineno-29-45"></a>[FAIL] 1.2.16 Ensure that the --audit-log-path argument is set (Automated)
</span><span id="__span-29-46"><a id="__codelineno-29-46" name="__codelineno-29-46" href="#__codelineno-29-46"></a>[FAIL] 1.2.17 Ensure that the --audit-log-maxage argument is set to 30 or as appropriate (Automated)
</span><span id="__span-29-47"><a id="__codelineno-29-47" name="__codelineno-29-47" href="#__codelineno-29-47"></a>[FAIL] 1.2.18 Ensure that the --audit-log-maxbackup argument is set to 10 or as appropriate (Automated)
</span><span id="__span-29-48"><a id="__codelineno-29-48" name="__codelineno-29-48" href="#__codelineno-29-48"></a>[FAIL] 1.2.19 Ensure that the --audit-log-maxsize argument is set to 100 or as appropriate (Automated)
</span><span id="__span-29-49"><a id="__codelineno-29-49" name="__codelineno-29-49" href="#__codelineno-29-49"></a>[WARN] 1.2.20 Ensure that the --request-timeout argument is set as appropriate (Manual)
</span><span id="__span-29-50"><a id="__codelineno-29-50" name="__codelineno-29-50" href="#__codelineno-29-50"></a>[PASS] 1.2.21 Ensure that the --service-account-lookup argument is set to true (Automated)
</span><span id="__span-29-51"><a id="__codelineno-29-51" name="__codelineno-29-51" href="#__codelineno-29-51"></a>[PASS] 1.2.22 Ensure that the --service-account-key-file argument is set as appropriate (Automated)
</span><span id="__span-29-52"><a id="__codelineno-29-52" name="__codelineno-29-52" href="#__codelineno-29-52"></a>[PASS] 1.2.23 Ensure that the --etcd-certfile and --etcd-keyfile arguments are set as appropriate (Automated)
</span><span id="__span-29-53"><a id="__codelineno-29-53" name="__codelineno-29-53" href="#__codelineno-29-53"></a>[PASS] 1.2.24 Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate (Automated)
</span><span id="__span-29-54"><a id="__codelineno-29-54" name="__codelineno-29-54" href="#__codelineno-29-54"></a>[PASS] 1.2.25 Ensure that the --client-ca-file argument is set as appropriate (Automated)
</span><span id="__span-29-55"><a id="__codelineno-29-55" name="__codelineno-29-55" href="#__codelineno-29-55"></a>[PASS] 1.2.26 Ensure that the --etcd-cafile argument is set as appropriate (Automated)
</span><span id="__span-29-56"><a id="__codelineno-29-56" name="__codelineno-29-56" href="#__codelineno-29-56"></a>[WARN] 1.2.27 Ensure that the --encryption-provider-config argument is set as appropriate (Manual)
</span><span id="__span-29-57"><a id="__codelineno-29-57" name="__codelineno-29-57" href="#__codelineno-29-57"></a>[WARN] 1.2.28 Ensure that encryption providers are appropriately configured (Manual)
</span><span id="__span-29-58"><a id="__codelineno-29-58" name="__codelineno-29-58" href="#__codelineno-29-58"></a>[WARN] 1.2.29 Ensure that the API Server only makes use of Strong Cryptographic Ciphers (Manual)
</span><span id="__span-29-59"><a id="__codelineno-29-59" name="__codelineno-29-59" href="#__codelineno-29-59"></a>[FAIL] 1.2.30 Ensure that the --service-account-extend-token-expiration parameter is set to false (Automated)
</span><span id="__span-29-60"><a id="__codelineno-29-60" name="__codelineno-29-60" href="#__codelineno-29-60"></a>[INFO] 1.3 Controller Manager
</span><span id="__span-29-61"><a id="__codelineno-29-61" name="__codelineno-29-61" href="#__codelineno-29-61"></a>[WARN] 1.3.1 Ensure that the --terminated-pod-gc-threshold argument is set as appropriate (Manual)
</span><span id="__span-29-62"><a id="__codelineno-29-62" name="__codelineno-29-62" href="#__codelineno-29-62"></a>[FAIL] 1.3.2 Ensure that the --profiling argument is set to false (Automated)
</span><span id="__span-29-63"><a id="__codelineno-29-63" name="__codelineno-29-63" href="#__codelineno-29-63"></a>[PASS] 1.3.3 Ensure that the --use-service-account-credentials argument is set to true (Automated)
</span><span id="__span-29-64"><a id="__codelineno-29-64" name="__codelineno-29-64" href="#__codelineno-29-64"></a>[PASS] 1.3.4 Ensure that the --service-account-private-key-file argument is set as appropriate (Automated)
</span><span id="__span-29-65"><a id="__codelineno-29-65" name="__codelineno-29-65" href="#__codelineno-29-65"></a>[PASS] 1.3.5 Ensure that the --root-ca-file argument is set as appropriate (Automated)
</span><span id="__span-29-66"><a id="__codelineno-29-66" name="__codelineno-29-66" href="#__codelineno-29-66"></a>[PASS] 1.3.6 Ensure that the RotateKubeletServerCertificate argument is set to true (Automated)
</span><span id="__span-29-67"><a id="__codelineno-29-67" name="__codelineno-29-67" href="#__codelineno-29-67"></a>[PASS] 1.3.7 Ensure that the --bind-address argument is set to 127.0.0.1 (Automated)
</span><span id="__span-29-68"><a id="__codelineno-29-68" name="__codelineno-29-68" href="#__codelineno-29-68"></a>[INFO] 1.4 Scheduler
</span><span id="__span-29-69"><a id="__codelineno-29-69" name="__codelineno-29-69" href="#__codelineno-29-69"></a>[FAIL] 1.4.1 Ensure that the --profiling argument is set to false (Automated)
</span><span id="__span-29-70"><a id="__codelineno-29-70" name="__codelineno-29-70" href="#__codelineno-29-70"></a>[PASS] 1.4.2 Ensure that the --bind-address argument is set to 127.0.0.1 (Automated)
</span><span id="__span-29-71"><a id="__codelineno-29-71" name="__codelineno-29-71" href="#__codelineno-29-71"></a>
</span><span id="__span-29-72"><a id="__codelineno-29-72" name="__codelineno-29-72" href="#__codelineno-29-72"></a>== Remediations master ==
</span><span id="__span-29-73"><a id="__codelineno-29-73" name="__codelineno-29-73" href="#__codelineno-29-73"></a>1.1.9 Run the below command (based on the file location on your system) on the control plane node.
</span><span id="__span-29-74"><a id="__codelineno-29-74" name="__codelineno-29-74" href="#__codelineno-29-74"></a>For example, chmod 600 &lt;path/to/cni/files&gt;
</span><span id="__span-29-75"><a id="__codelineno-29-75" name="__codelineno-29-75" href="#__codelineno-29-75"></a>
</span><span id="__span-29-76"><a id="__codelineno-29-76" name="__codelineno-29-76" href="#__codelineno-29-76"></a>1.1.12 On the etcd server node, get the etcd data directory, passed as an argument --data-dir,
</span><span id="__span-29-77"><a id="__codelineno-29-77" name="__codelineno-29-77" href="#__codelineno-29-77"></a>from the command 'ps -ef | grep etcd'.
</span><span id="__span-29-78"><a id="__codelineno-29-78" name="__codelineno-29-78" href="#__codelineno-29-78"></a>Run the below command (based on the etcd data directory found above).
</span><span id="__span-29-79"><a id="__codelineno-29-79" name="__codelineno-29-79" href="#__codelineno-29-79"></a>For example, chown etcd:etcd /var/lib/etcd
</span><span id="__span-29-80"><a id="__codelineno-29-80" name="__codelineno-29-80" href="#__codelineno-29-80"></a>
</span><span id="__span-29-81"><a id="__codelineno-29-81" name="__codelineno-29-81" href="#__codelineno-29-81"></a>1.2.1 Edit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml
</span><span id="__span-29-82"><a id="__codelineno-29-82" name="__codelineno-29-82" href="#__codelineno-29-82"></a>on the control plane node and set the below parameter.
</span><span id="__span-29-83"><a id="__codelineno-29-83" name="__codelineno-29-83" href="#__codelineno-29-83"></a>--anonymous-auth=false
</span><span id="__span-29-84"><a id="__codelineno-29-84" name="__codelineno-29-84" href="#__codelineno-29-84"></a>
</span><span id="__span-29-85"><a id="__codelineno-29-85" name="__codelineno-29-85" href="#__codelineno-29-85"></a>1.2.3 Edit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml
</span><span id="__span-29-86"><a id="__codelineno-29-86" name="__codelineno-29-86" href="#__codelineno-29-86"></a>on the control plane node and add the `DenyServiceExternalIPs` plugin
</span><span id="__span-29-87"><a id="__codelineno-29-87" name="__codelineno-29-87" href="#__codelineno-29-87"></a>to the enabled admission plugins, as such --enable-admission-plugin=DenyServiceExternalIPs.
</span><span id="__span-29-88"><a id="__codelineno-29-88" name="__codelineno-29-88" href="#__codelineno-29-88"></a>
</span><span id="__span-29-89"><a id="__codelineno-29-89" name="__codelineno-29-89" href="#__codelineno-29-89"></a>1.2.5 Follow the Kubernetes documentation and setup the TLS connection between
</span><span id="__span-29-90"><a id="__codelineno-29-90" name="__codelineno-29-90" href="#__codelineno-29-90"></a>the apiserver and kubelets. Then, edit the API server pod specification file
</span><span id="__span-29-91"><a id="__codelineno-29-91" name="__codelineno-29-91" href="#__codelineno-29-91"></a>/etc/kubernetes/manifests/kube-apiserver.yaml on the control plane node and set the
</span><span id="__span-29-92"><a id="__codelineno-29-92" name="__codelineno-29-92" href="#__codelineno-29-92"></a>--kubelet-certificate-authority parameter to the path to the cert file for the certificate authority.
</span><span id="__span-29-93"><a id="__codelineno-29-93" name="__codelineno-29-93" href="#__codelineno-29-93"></a>--kubelet-certificate-authority=&lt;ca-string&gt;
</span><span id="__span-29-94"><a id="__codelineno-29-94" name="__codelineno-29-94" href="#__codelineno-29-94"></a>
</span><span id="__span-29-95"><a id="__codelineno-29-95" name="__codelineno-29-95" href="#__codelineno-29-95"></a>1.2.9 Follow the Kubernetes documentation and set the desired limits in a configuration file.
</span><span id="__span-29-96"><a id="__codelineno-29-96" name="__codelineno-29-96" href="#__codelineno-29-96"></a>Then, edit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml
</span><span id="__span-29-97"><a id="__codelineno-29-97" name="__codelineno-29-97" href="#__codelineno-29-97"></a>and set the below parameters.
</span><span id="__span-29-98"><a id="__codelineno-29-98" name="__codelineno-29-98" href="#__codelineno-29-98"></a>--enable-admission-plugins=...,EventRateLimit,...
</span><span id="__span-29-99"><a id="__codelineno-29-99" name="__codelineno-29-99" href="#__codelineno-29-99"></a>--admission-control-config-file=&lt;path/to/configuration/file&gt;
</span><span id="__span-29-100"><a id="__codelineno-29-100" name="__codelineno-29-100" href="#__codelineno-29-100"></a>
</span><span id="__span-29-101"><a id="__codelineno-29-101" name="__codelineno-29-101" href="#__codelineno-29-101"></a>1.2.11 Edit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml
</span><span id="__span-29-102"><a id="__codelineno-29-102" name="__codelineno-29-102" href="#__codelineno-29-102"></a>on the control plane node and set the --enable-admission-plugins parameter to include
</span><span id="__span-29-103"><a id="__codelineno-29-103" name="__codelineno-29-103" href="#__codelineno-29-103"></a>AlwaysPullImages.
</span><span id="__span-29-104"><a id="__codelineno-29-104" name="__codelineno-29-104" href="#__codelineno-29-104"></a>--enable-admission-plugins=...,AlwaysPullImages,...
</span><span id="__span-29-105"><a id="__codelineno-29-105" name="__codelineno-29-105" href="#__codelineno-29-105"></a>
</span><span id="__span-29-106"><a id="__codelineno-29-106" name="__codelineno-29-106" href="#__codelineno-29-106"></a>1.2.15 Edit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml
</span><span id="__span-29-107"><a id="__codelineno-29-107" name="__codelineno-29-107" href="#__codelineno-29-107"></a>on the control plane node and set the below parameter.
</span><span id="__span-29-108"><a id="__codelineno-29-108" name="__codelineno-29-108" href="#__codelineno-29-108"></a>--profiling=false
</span><span id="__span-29-109"><a id="__codelineno-29-109" name="__codelineno-29-109" href="#__codelineno-29-109"></a>
</span><span id="__span-29-110"><a id="__codelineno-29-110" name="__codelineno-29-110" href="#__codelineno-29-110"></a>1.2.16 Edit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml
</span><span id="__span-29-111"><a id="__codelineno-29-111" name="__codelineno-29-111" href="#__codelineno-29-111"></a>on the control plane node and set the --audit-log-path parameter to a suitable path and
</span><span id="__span-29-112"><a id="__codelineno-29-112" name="__codelineno-29-112" href="#__codelineno-29-112"></a>file where you would like audit logs to be written, for example,
</span><span id="__span-29-113"><a id="__codelineno-29-113" name="__codelineno-29-113" href="#__codelineno-29-113"></a>--audit-log-path=/var/log/apiserver/audit.log
</span><span id="__span-29-114"><a id="__codelineno-29-114" name="__codelineno-29-114" href="#__codelineno-29-114"></a>
</span><span id="__span-29-115"><a id="__codelineno-29-115" name="__codelineno-29-115" href="#__codelineno-29-115"></a>1.2.17 Edit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml
</span><span id="__span-29-116"><a id="__codelineno-29-116" name="__codelineno-29-116" href="#__codelineno-29-116"></a>on the control plane node and set the --audit-log-maxage parameter to 30
</span><span id="__span-29-117"><a id="__codelineno-29-117" name="__codelineno-29-117" href="#__codelineno-29-117"></a>or as an appropriate number of days, for example,
</span><span id="__span-29-118"><a id="__codelineno-29-118" name="__codelineno-29-118" href="#__codelineno-29-118"></a>--audit-log-maxage=30
</span><span id="__span-29-119"><a id="__codelineno-29-119" name="__codelineno-29-119" href="#__codelineno-29-119"></a>
</span><span id="__span-29-120"><a id="__codelineno-29-120" name="__codelineno-29-120" href="#__codelineno-29-120"></a>1.2.18 Edit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml
</span><span id="__span-29-121"><a id="__codelineno-29-121" name="__codelineno-29-121" href="#__codelineno-29-121"></a>on the control plane node and set the --audit-log-maxbackup parameter to 10 or to an appropriate
</span><span id="__span-29-122"><a id="__codelineno-29-122" name="__codelineno-29-122" href="#__codelineno-29-122"></a>value. For example,
</span><span id="__span-29-123"><a id="__codelineno-29-123" name="__codelineno-29-123" href="#__codelineno-29-123"></a>--audit-log-maxbackup=10
</span><span id="__span-29-124"><a id="__codelineno-29-124" name="__codelineno-29-124" href="#__codelineno-29-124"></a>
</span><span id="__span-29-125"><a id="__codelineno-29-125" name="__codelineno-29-125" href="#__codelineno-29-125"></a>1.2.19 Edit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml
</span><span id="__span-29-126"><a id="__codelineno-29-126" name="__codelineno-29-126" href="#__codelineno-29-126"></a>on the control plane node and set the --audit-log-maxsize parameter to an appropriate size in MB.
</span><span id="__span-29-127"><a id="__codelineno-29-127" name="__codelineno-29-127" href="#__codelineno-29-127"></a>For example, to set it as 100 MB, --audit-log-maxsize=100
</span><span id="__span-29-128"><a id="__codelineno-29-128" name="__codelineno-29-128" href="#__codelineno-29-128"></a>
</span><span id="__span-29-129"><a id="__codelineno-29-129" name="__codelineno-29-129" href="#__codelineno-29-129"></a>1.2.20 Edit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml
</span><span id="__span-29-130"><a id="__codelineno-29-130" name="__codelineno-29-130" href="#__codelineno-29-130"></a>and set the below parameter as appropriate and if needed.
</span><span id="__span-29-131"><a id="__codelineno-29-131" name="__codelineno-29-131" href="#__codelineno-29-131"></a>For example, --request-timeout=300s
</span><span id="__span-29-132"><a id="__codelineno-29-132" name="__codelineno-29-132" href="#__codelineno-29-132"></a>
</span><span id="__span-29-133"><a id="__codelineno-29-133" name="__codelineno-29-133" href="#__codelineno-29-133"></a>1.2.27 Follow the Kubernetes documentation and configure a EncryptionConfig file.
</span><span id="__span-29-134"><a id="__codelineno-29-134" name="__codelineno-29-134" href="#__codelineno-29-134"></a>Then, edit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml
</span><span id="__span-29-135"><a id="__codelineno-29-135" name="__codelineno-29-135" href="#__codelineno-29-135"></a>on the control plane node and set the --encryption-provider-config parameter to the path of that file.
</span><span id="__span-29-136"><a id="__codelineno-29-136" name="__codelineno-29-136" href="#__codelineno-29-136"></a>For example, --encryption-provider-config=&lt;/path/to/EncryptionConfig/File&gt;
</span><span id="__span-29-137"><a id="__codelineno-29-137" name="__codelineno-29-137" href="#__codelineno-29-137"></a>
</span><span id="__span-29-138"><a id="__codelineno-29-138" name="__codelineno-29-138" href="#__codelineno-29-138"></a>1.2.28 Follow the Kubernetes documentation and configure a EncryptionConfig file.
</span><span id="__span-29-139"><a id="__codelineno-29-139" name="__codelineno-29-139" href="#__codelineno-29-139"></a>In this file, choose aescbc, kms or secretbox as the encryption provider.
</span><span id="__span-29-140"><a id="__codelineno-29-140" name="__codelineno-29-140" href="#__codelineno-29-140"></a>
</span><span id="__span-29-141"><a id="__codelineno-29-141" name="__codelineno-29-141" href="#__codelineno-29-141"></a>1.2.29 Edit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml
</span><span id="__span-29-142"><a id="__codelineno-29-142" name="__codelineno-29-142" href="#__codelineno-29-142"></a>on the control plane node and set the below parameter.
</span><span id="__span-29-143"><a id="__codelineno-29-143" name="__codelineno-29-143" href="#__codelineno-29-143"></a>--tls-cipher-suites=TLS_AES_128_GCM_SHA256,TLS_AES_256_GCM_SHA384,TLS_CHACHA20_POLY1305_SHA256,
</span><span id="__span-29-144"><a id="__codelineno-29-144" name="__codelineno-29-144" href="#__codelineno-29-144"></a>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,
</span><span id="__span-29-145"><a id="__codelineno-29-145" name="__codelineno-29-145" href="#__codelineno-29-145"></a>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,
</span><span id="__span-29-146"><a id="__codelineno-29-146" name="__codelineno-29-146" href="#__codelineno-29-146"></a>TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256,
</span><span id="__span-29-147"><a id="__codelineno-29-147" name="__codelineno-29-147" href="#__codelineno-29-147"></a>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,
</span><span id="__span-29-148"><a id="__codelineno-29-148" name="__codelineno-29-148" href="#__codelineno-29-148"></a>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256
</span><span id="__span-29-149"><a id="__codelineno-29-149" name="__codelineno-29-149" href="#__codelineno-29-149"></a>
</span><span id="__span-29-150"><a id="__codelineno-29-150" name="__codelineno-29-150" href="#__codelineno-29-150"></a>1.2.30 Edit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml on the Control Plane node and set the --service-account-extend-token-expiration parameter to false.
</span><span id="__span-29-151"><a id="__codelineno-29-151" name="__codelineno-29-151" href="#__codelineno-29-151"></a>`--service-account-extend-token-expiration=false`
</span><span id="__span-29-152"><a id="__codelineno-29-152" name="__codelineno-29-152" href="#__codelineno-29-152"></a>By default, this parameter is set to true.
</span><span id="__span-29-153"><a id="__codelineno-29-153" name="__codelineno-29-153" href="#__codelineno-29-153"></a>
</span><span id="__span-29-154"><a id="__codelineno-29-154" name="__codelineno-29-154" href="#__codelineno-29-154"></a>1.3.1 Edit the Controller Manager pod specification file /etc/kubernetes/manifests/kube-controller-manager.yaml
</span><span id="__span-29-155"><a id="__codelineno-29-155" name="__codelineno-29-155" href="#__codelineno-29-155"></a>on the control plane node and set the --terminated-pod-gc-threshold to an appropriate threshold,
</span><span id="__span-29-156"><a id="__codelineno-29-156" name="__codelineno-29-156" href="#__codelineno-29-156"></a>for example, --terminated-pod-gc-threshold=10
</span><span id="__span-29-157"><a id="__codelineno-29-157" name="__codelineno-29-157" href="#__codelineno-29-157"></a>
</span><span id="__span-29-158"><a id="__codelineno-29-158" name="__codelineno-29-158" href="#__codelineno-29-158"></a>1.3.2 Edit the Controller Manager pod specification file /etc/kubernetes/manifests/kube-controller-manager.yaml
</span><span id="__span-29-159"><a id="__codelineno-29-159" name="__codelineno-29-159" href="#__codelineno-29-159"></a>on the control plane node and set the below parameter.
</span><span id="__span-29-160"><a id="__codelineno-29-160" name="__codelineno-29-160" href="#__codelineno-29-160"></a>--profiling=false
</span><span id="__span-29-161"><a id="__codelineno-29-161" name="__codelineno-29-161" href="#__codelineno-29-161"></a>
</span><span id="__span-29-162"><a id="__codelineno-29-162" name="__codelineno-29-162" href="#__codelineno-29-162"></a>1.4.1 Edit the Scheduler pod specification file /etc/kubernetes/manifests/kube-scheduler.yaml file
</span><span id="__span-29-163"><a id="__codelineno-29-163" name="__codelineno-29-163" href="#__codelineno-29-163"></a>on the control plane node and set the below parameter.
</span><span id="__span-29-164"><a id="__codelineno-29-164" name="__codelineno-29-164" href="#__codelineno-29-164"></a>--profiling=false
</span><span id="__span-29-165"><a id="__codelineno-29-165" name="__codelineno-29-165" href="#__codelineno-29-165"></a>
</span><span id="__span-29-166"><a id="__codelineno-29-166" name="__codelineno-29-166" href="#__codelineno-29-166"></a>
</span><span id="__span-29-167"><a id="__codelineno-29-167" name="__codelineno-29-167" href="#__codelineno-29-167"></a>== Summary master ==
</span><span id="__span-29-168"><a id="__codelineno-29-168" name="__codelineno-29-168" href="#__codelineno-29-168"></a>40 checks PASS
</span><span id="__span-29-169"><a id="__codelineno-29-169" name="__codelineno-29-169" href="#__codelineno-29-169"></a>10 checks FAIL
</span><span id="__span-29-170"><a id="__codelineno-29-170" name="__codelineno-29-170" href="#__codelineno-29-170"></a>10 checks WARN
</span><span id="__span-29-171"><a id="__codelineno-29-171" name="__codelineno-29-171" href="#__codelineno-29-171"></a>0 checks INFO
</span><span id="__span-29-172"><a id="__codelineno-29-172" name="__codelineno-29-172" href="#__codelineno-29-172"></a>
</span><span id="__span-29-173"><a id="__codelineno-29-173" name="__codelineno-29-173" href="#__codelineno-29-173"></a>[INFO] 2 Etcd Node Configuration
</span><span id="__span-29-174"><a id="__codelineno-29-174" name="__codelineno-29-174" href="#__codelineno-29-174"></a>[INFO] 2 Etcd Node Configuration
</span><span id="__span-29-175"><a id="__codelineno-29-175" name="__codelineno-29-175" href="#__codelineno-29-175"></a>[PASS] 2.1 Ensure that the --cert-file and --key-file arguments are set as appropriate (Automated)
</span><span id="__span-29-176"><a id="__codelineno-29-176" name="__codelineno-29-176" href="#__codelineno-29-176"></a>[PASS] 2.2 Ensure that the --client-cert-auth argument is set to true (Automated)
</span><span id="__span-29-177"><a id="__codelineno-29-177" name="__codelineno-29-177" href="#__codelineno-29-177"></a>[PASS] 2.3 Ensure that the --auto-tls argument is not set to true (Automated)
</span><span id="__span-29-178"><a id="__codelineno-29-178" name="__codelineno-29-178" href="#__codelineno-29-178"></a>[PASS] 2.4 Ensure that the --peer-cert-file and --peer-key-file arguments are set as appropriate (Automated)
</span><span id="__span-29-179"><a id="__codelineno-29-179" name="__codelineno-29-179" href="#__codelineno-29-179"></a>[PASS] 2.5 Ensure that the --peer-client-cert-auth argument is set to true (Automated)
</span><span id="__span-29-180"><a id="__codelineno-29-180" name="__codelineno-29-180" href="#__codelineno-29-180"></a>[PASS] 2.6 Ensure that the --peer-auto-tls argument is not set to true (Automated)
</span><span id="__span-29-181"><a id="__codelineno-29-181" name="__codelineno-29-181" href="#__codelineno-29-181"></a>[PASS] 2.7 Ensure that a unique Certificate Authority is used for etcd (Manual)
</span><span id="__span-29-182"><a id="__codelineno-29-182" name="__codelineno-29-182" href="#__codelineno-29-182"></a>
</span><span id="__span-29-183"><a id="__codelineno-29-183" name="__codelineno-29-183" href="#__codelineno-29-183"></a>== Summary etcd ==
</span><span id="__span-29-184"><a id="__codelineno-29-184" name="__codelineno-29-184" href="#__codelineno-29-184"></a>7 checks PASS
</span><span id="__span-29-185"><a id="__codelineno-29-185" name="__codelineno-29-185" href="#__codelineno-29-185"></a>0 checks FAIL
</span><span id="__span-29-186"><a id="__codelineno-29-186" name="__codelineno-29-186" href="#__codelineno-29-186"></a>0 checks WARN
</span><span id="__span-29-187"><a id="__codelineno-29-187" name="__codelineno-29-187" href="#__codelineno-29-187"></a>0 checks INFO
</span><span id="__span-29-188"><a id="__codelineno-29-188" name="__codelineno-29-188" href="#__codelineno-29-188"></a>
</span><span id="__span-29-189"><a id="__codelineno-29-189" name="__codelineno-29-189" href="#__codelineno-29-189"></a>[INFO] 3 Control Plane Configuration
</span><span id="__span-29-190"><a id="__codelineno-29-190" name="__codelineno-29-190" href="#__codelineno-29-190"></a>[INFO] 3.1 Authentication and Authorization
</span><span id="__span-29-191"><a id="__codelineno-29-191" name="__codelineno-29-191" href="#__codelineno-29-191"></a>[WARN] 3.1.1 Client certificate authentication should not be used for users (Manual)
</span><span id="__span-29-192"><a id="__codelineno-29-192" name="__codelineno-29-192" href="#__codelineno-29-192"></a>[WARN] 3.1.2 Service account token authentication should not be used for users (Manual)
</span><span id="__span-29-193"><a id="__codelineno-29-193" name="__codelineno-29-193" href="#__codelineno-29-193"></a>[WARN] 3.1.3 Bootstrap token authentication should not be used for users (Manual)
</span><span id="__span-29-194"><a id="__codelineno-29-194" name="__codelineno-29-194" href="#__codelineno-29-194"></a>[INFO] 3.2 Logging
</span><span id="__span-29-195"><a id="__codelineno-29-195" name="__codelineno-29-195" href="#__codelineno-29-195"></a>[WARN] 3.2.1 Ensure that a minimal audit policy is created (Manual)
</span><span id="__span-29-196"><a id="__codelineno-29-196" name="__codelineno-29-196" href="#__codelineno-29-196"></a>[WARN] 3.2.2 Ensure that the audit policy covers key security concerns (Manual)
</span><span id="__span-29-197"><a id="__codelineno-29-197" name="__codelineno-29-197" href="#__codelineno-29-197"></a>
</span><span id="__span-29-198"><a id="__codelineno-29-198" name="__codelineno-29-198" href="#__codelineno-29-198"></a>== Remediations controlplane ==
</span><span id="__span-29-199"><a id="__codelineno-29-199" name="__codelineno-29-199" href="#__codelineno-29-199"></a>3.1.1 Alternative mechanisms provided by Kubernetes such as the use of OIDC should be
</span><span id="__span-29-200"><a id="__codelineno-29-200" name="__codelineno-29-200" href="#__codelineno-29-200"></a>implemented in place of client certificates.
</span><span id="__span-29-201"><a id="__codelineno-29-201" name="__codelineno-29-201" href="#__codelineno-29-201"></a>
</span><span id="__span-29-202"><a id="__codelineno-29-202" name="__codelineno-29-202" href="#__codelineno-29-202"></a>3.1.2 Alternative mechanisms provided by Kubernetes such as the use of OIDC should be implemented
</span><span id="__span-29-203"><a id="__codelineno-29-203" name="__codelineno-29-203" href="#__codelineno-29-203"></a>in place of service account tokens.
</span><span id="__span-29-204"><a id="__codelineno-29-204" name="__codelineno-29-204" href="#__codelineno-29-204"></a>
</span><span id="__span-29-205"><a id="__codelineno-29-205" name="__codelineno-29-205" href="#__codelineno-29-205"></a>3.1.3 Alternative mechanisms provided by Kubernetes such as the use of OIDC should be implemented
</span><span id="__span-29-206"><a id="__codelineno-29-206" name="__codelineno-29-206" href="#__codelineno-29-206"></a>in place of bootstrap tokens.
</span><span id="__span-29-207"><a id="__codelineno-29-207" name="__codelineno-29-207" href="#__codelineno-29-207"></a>
</span><span id="__span-29-208"><a id="__codelineno-29-208" name="__codelineno-29-208" href="#__codelineno-29-208"></a>3.2.1 Create an audit policy file for your cluster.
</span><span id="__span-29-209"><a id="__codelineno-29-209" name="__codelineno-29-209" href="#__codelineno-29-209"></a>
</span><span id="__span-29-210"><a id="__codelineno-29-210" name="__codelineno-29-210" href="#__codelineno-29-210"></a>3.2.2 Review the audit policy provided for the cluster and ensure that it covers
</span><span id="__span-29-211"><a id="__codelineno-29-211" name="__codelineno-29-211" href="#__codelineno-29-211"></a>at least the following areas,
</span><span id="__span-29-212"><a id="__codelineno-29-212" name="__codelineno-29-212" href="#__codelineno-29-212"></a>- Access to Secrets managed by the cluster. Care should be taken to only
</span><span id="__span-29-213"><a id="__codelineno-29-213" name="__codelineno-29-213" href="#__codelineno-29-213"></a>  log Metadata for requests to Secrets, ConfigMaps, and TokenReviews, in
</span><span id="__span-29-214"><a id="__codelineno-29-214" name="__codelineno-29-214" href="#__codelineno-29-214"></a>  order to avoid risk of logging sensitive data.
</span><span id="__span-29-215"><a id="__codelineno-29-215" name="__codelineno-29-215" href="#__codelineno-29-215"></a>- Modification of Pod and Deployment objects.
</span><span id="__span-29-216"><a id="__codelineno-29-216" name="__codelineno-29-216" href="#__codelineno-29-216"></a>- Use of `pods/exec`, `pods/portforward`, `pods/proxy` and `services/proxy`.
</span><span id="__span-29-217"><a id="__codelineno-29-217" name="__codelineno-29-217" href="#__codelineno-29-217"></a>For most requests, minimally logging at the Metadata level is recommended
</span><span id="__span-29-218"><a id="__codelineno-29-218" name="__codelineno-29-218" href="#__codelineno-29-218"></a>(the most basic level of logging).
</span><span id="__span-29-219"><a id="__codelineno-29-219" name="__codelineno-29-219" href="#__codelineno-29-219"></a>
</span><span id="__span-29-220"><a id="__codelineno-29-220" name="__codelineno-29-220" href="#__codelineno-29-220"></a>
</span><span id="__span-29-221"><a id="__codelineno-29-221" name="__codelineno-29-221" href="#__codelineno-29-221"></a>== Summary controlplane ==
</span><span id="__span-29-222"><a id="__codelineno-29-222" name="__codelineno-29-222" href="#__codelineno-29-222"></a>0 checks PASS
</span><span id="__span-29-223"><a id="__codelineno-29-223" name="__codelineno-29-223" href="#__codelineno-29-223"></a>0 checks FAIL
</span><span id="__span-29-224"><a id="__codelineno-29-224" name="__codelineno-29-224" href="#__codelineno-29-224"></a>5 checks WARN
</span><span id="__span-29-225"><a id="__codelineno-29-225" name="__codelineno-29-225" href="#__codelineno-29-225"></a>0 checks INFO
</span><span id="__span-29-226"><a id="__codelineno-29-226" name="__codelineno-29-226" href="#__codelineno-29-226"></a>
</span><span id="__span-29-227"><a id="__codelineno-29-227" name="__codelineno-29-227" href="#__codelineno-29-227"></a>[INFO] 4 Worker Node Security Configuration
</span><span id="__span-29-228"><a id="__codelineno-29-228" name="__codelineno-29-228" href="#__codelineno-29-228"></a>[INFO] 4.1 Worker Node Configuration Files
</span><span id="__span-29-229"><a id="__codelineno-29-229" name="__codelineno-29-229" href="#__codelineno-29-229"></a>[FAIL] 4.1.1 Ensure that the kubelet service file permissions are set to 600 or more restrictive (Automated)
</span><span id="__span-29-230"><a id="__codelineno-29-230" name="__codelineno-29-230" href="#__codelineno-29-230"></a>[PASS] 4.1.2 Ensure that the kubelet service file ownership is set to root:root (Automated)
</span><span id="__span-29-231"><a id="__codelineno-29-231" name="__codelineno-29-231" href="#__codelineno-29-231"></a>[WARN] 4.1.3 If proxy kubeconfig file exists ensure permissions are set to 600 or more restrictive (Manual)
</span><span id="__span-29-232"><a id="__codelineno-29-232" name="__codelineno-29-232" href="#__codelineno-29-232"></a>[WARN] 4.1.4 If proxy kubeconfig file exists ensure ownership is set to root:root (Manual)
</span><span id="__span-29-233"><a id="__codelineno-29-233" name="__codelineno-29-233" href="#__codelineno-29-233"></a>[PASS] 4.1.5 Ensure that the --kubeconfig kubelet.conf file permissions are set to 600 or more restrictive (Automated)
</span><span id="__span-29-234"><a id="__codelineno-29-234" name="__codelineno-29-234" href="#__codelineno-29-234"></a>[PASS] 4.1.6 Ensure that the --kubeconfig kubelet.conf file ownership is set to root:root (Automated)
</span><span id="__span-29-235"><a id="__codelineno-29-235" name="__codelineno-29-235" href="#__codelineno-29-235"></a>[PASS] 4.1.7 Ensure that the certificate authorities file permissions are set to 644 or more restrictive (Manual)
</span><span id="__span-29-236"><a id="__codelineno-29-236" name="__codelineno-29-236" href="#__codelineno-29-236"></a>[PASS] 4.1.8 Ensure that the client certificate authorities file ownership is set to root:root (Manual)
</span><span id="__span-29-237"><a id="__codelineno-29-237" name="__codelineno-29-237" href="#__codelineno-29-237"></a>[FAIL] 4.1.9 If the kubelet config.yaml configuration file is being used validate permissions set to 600 or more restrictive (Automated)
</span><span id="__span-29-238"><a id="__codelineno-29-238" name="__codelineno-29-238" href="#__codelineno-29-238"></a>[PASS] 4.1.10 If the kubelet config.yaml configuration file is being used validate file ownership is set to root:root (Automated)
</span><span id="__span-29-239"><a id="__codelineno-29-239" name="__codelineno-29-239" href="#__codelineno-29-239"></a>[INFO] 4.2 Kubelet
</span><span id="__span-29-240"><a id="__codelineno-29-240" name="__codelineno-29-240" href="#__codelineno-29-240"></a>[PASS] 4.2.1 Ensure that the --anonymous-auth argument is set to false (Automated)
</span><span id="__span-29-241"><a id="__codelineno-29-241" name="__codelineno-29-241" href="#__codelineno-29-241"></a>[PASS] 4.2.2 Ensure that the --authorization-mode argument is not set to AlwaysAllow (Automated)
</span><span id="__span-29-242"><a id="__codelineno-29-242" name="__codelineno-29-242" href="#__codelineno-29-242"></a>[PASS] 4.2.3 Ensure that the --client-ca-file argument is set as appropriate (Automated)
</span><span id="__span-29-243"><a id="__codelineno-29-243" name="__codelineno-29-243" href="#__codelineno-29-243"></a>[PASS] 4.2.4 Verify that if defined, the --read-only-port argument is set to 0 (Manual)
</span><span id="__span-29-244"><a id="__codelineno-29-244" name="__codelineno-29-244" href="#__codelineno-29-244"></a>[PASS] 4.2.5 Ensure that the --streaming-connection-idle-timeout argument is not set to 0 (Manual)
</span><span id="__span-29-245"><a id="__codelineno-29-245" name="__codelineno-29-245" href="#__codelineno-29-245"></a>[PASS] 4.2.6 Ensure that the --make-iptables-util-chains argument is set to true (Automated)
</span><span id="__span-29-246"><a id="__codelineno-29-246" name="__codelineno-29-246" href="#__codelineno-29-246"></a>[PASS] 4.2.7 Ensure that the --hostname-override argument is not set (Manual)
</span><span id="__span-29-247"><a id="__codelineno-29-247" name="__codelineno-29-247" href="#__codelineno-29-247"></a>[PASS] 4.2.8 Ensure that the eventRecordQPS argument is set to a level which ensures appropriate event capture (Manual)
</span><span id="__span-29-248"><a id="__codelineno-29-248" name="__codelineno-29-248" href="#__codelineno-29-248"></a>[WARN] 4.2.9 Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate (Manual)
</span><span id="__span-29-249"><a id="__codelineno-29-249" name="__codelineno-29-249" href="#__codelineno-29-249"></a>[PASS] 4.2.10 Ensure that the --rotate-certificates argument is not set to false (Automated)
</span><span id="__span-29-250"><a id="__codelineno-29-250" name="__codelineno-29-250" href="#__codelineno-29-250"></a>[PASS] 4.2.11 Verify that the RotateKubeletServerCertificate argument is set to true (Manual)
</span><span id="__span-29-251"><a id="__codelineno-29-251" name="__codelineno-29-251" href="#__codelineno-29-251"></a>[WARN] 4.2.12 Ensure that the Kubelet only makes use of Strong Cryptographic Ciphers (Manual)
</span><span id="__span-29-252"><a id="__codelineno-29-252" name="__codelineno-29-252" href="#__codelineno-29-252"></a>[WARN] 4.2.13 Ensure that a limit is set on pod PIDs (Manual)
</span><span id="__span-29-253"><a id="__codelineno-29-253" name="__codelineno-29-253" href="#__codelineno-29-253"></a>[WARN] 4.2.14 Ensure that the --seccomp-default parameter is set to true (Manual)
</span><span id="__span-29-254"><a id="__codelineno-29-254" name="__codelineno-29-254" href="#__codelineno-29-254"></a>[WARN] 4.2.15 Ensure that the --IPAddressDeny is set to any (Manual)
</span><span id="__span-29-255"><a id="__codelineno-29-255" name="__codelineno-29-255" href="#__codelineno-29-255"></a>[INFO] 4.3 kube-proxy
</span><span id="__span-29-256"><a id="__codelineno-29-256" name="__codelineno-29-256" href="#__codelineno-29-256"></a>[PASS] 4.3.1 Ensure that the kube-proxy metrics service is bound to localhost (Automated)
</span><span id="__span-29-257"><a id="__codelineno-29-257" name="__codelineno-29-257" href="#__codelineno-29-257"></a>
</span><span id="__span-29-258"><a id="__codelineno-29-258" name="__codelineno-29-258" href="#__codelineno-29-258"></a>== Remediations node ==
</span><span id="__span-29-259"><a id="__codelineno-29-259" name="__codelineno-29-259" href="#__codelineno-29-259"></a>4.1.1 Run the below command (based on the file location on your system) on the each worker node.
</span><span id="__span-29-260"><a id="__codelineno-29-260" name="__codelineno-29-260" href="#__codelineno-29-260"></a>For example, chmod 600 /lib/systemd/system/kubelet.service
</span><span id="__span-29-261"><a id="__codelineno-29-261" name="__codelineno-29-261" href="#__codelineno-29-261"></a>
</span><span id="__span-29-262"><a id="__codelineno-29-262" name="__codelineno-29-262" href="#__codelineno-29-262"></a>4.1.3 Run the below command (based on the file location on your system) on the each worker node.
</span><span id="__span-29-263"><a id="__codelineno-29-263" name="__codelineno-29-263" href="#__codelineno-29-263"></a>For example,
</span><span id="__span-29-264"><a id="__codelineno-29-264" name="__codelineno-29-264" href="#__codelineno-29-264"></a>chmod 600 /etc/kubernetes/proxy.conf
</span><span id="__span-29-265"><a id="__codelineno-29-265" name="__codelineno-29-265" href="#__codelineno-29-265"></a>
</span><span id="__span-29-266"><a id="__codelineno-29-266" name="__codelineno-29-266" href="#__codelineno-29-266"></a>4.1.4 Run the below command (based on the file location on your system) on the each worker node.
</span><span id="__span-29-267"><a id="__codelineno-29-267" name="__codelineno-29-267" href="#__codelineno-29-267"></a>For example, chown root:root /etc/kubernetes/proxy.conf
</span><span id="__span-29-268"><a id="__codelineno-29-268" name="__codelineno-29-268" href="#__codelineno-29-268"></a>
</span><span id="__span-29-269"><a id="__codelineno-29-269" name="__codelineno-29-269" href="#__codelineno-29-269"></a>4.1.9 Run the following command (using the config file location identified in the Audit step)
</span><span id="__span-29-270"><a id="__codelineno-29-270" name="__codelineno-29-270" href="#__codelineno-29-270"></a>chmod 600 /var/lib/kubelet/config.yaml
</span><span id="__span-29-271"><a id="__codelineno-29-271" name="__codelineno-29-271" href="#__codelineno-29-271"></a>
</span><span id="__span-29-272"><a id="__codelineno-29-272" name="__codelineno-29-272" href="#__codelineno-29-272"></a>4.2.9 If using a Kubelet config file, edit the file to set `tlsCertFile` to the location
</span><span id="__span-29-273"><a id="__codelineno-29-273" name="__codelineno-29-273" href="#__codelineno-29-273"></a>of the certificate file to use to identify this Kubelet, and `tlsPrivateKeyFile`
</span><span id="__span-29-274"><a id="__codelineno-29-274" name="__codelineno-29-274" href="#__codelineno-29-274"></a>to the location of the corresponding private key file.
</span><span id="__span-29-275"><a id="__codelineno-29-275" name="__codelineno-29-275" href="#__codelineno-29-275"></a>If using command line arguments, edit the kubelet service file
</span><span id="__span-29-276"><a id="__codelineno-29-276" name="__codelineno-29-276" href="#__codelineno-29-276"></a>/lib/systemd/system/kubelet.service on each worker node and
</span><span id="__span-29-277"><a id="__codelineno-29-277" name="__codelineno-29-277" href="#__codelineno-29-277"></a>set the below parameters in KUBELET_CERTIFICATE_ARGS variable.
</span><span id="__span-29-278"><a id="__codelineno-29-278" name="__codelineno-29-278" href="#__codelineno-29-278"></a>--tls-cert-file=&lt;path/to/tls-certificate-file&gt;
</span><span id="__span-29-279"><a id="__codelineno-29-279" name="__codelineno-29-279" href="#__codelineno-29-279"></a>--tls-private-key-file=&lt;path/to/tls-key-file&gt;
</span><span id="__span-29-280"><a id="__codelineno-29-280" name="__codelineno-29-280" href="#__codelineno-29-280"></a>Based on your system, restart the kubelet service. For example,
</span><span id="__span-29-281"><a id="__codelineno-29-281" name="__codelineno-29-281" href="#__codelineno-29-281"></a>systemctl daemon-reload
</span><span id="__span-29-282"><a id="__codelineno-29-282" name="__codelineno-29-282" href="#__codelineno-29-282"></a>systemctl restart kubelet.service
</span><span id="__span-29-283"><a id="__codelineno-29-283" name="__codelineno-29-283" href="#__codelineno-29-283"></a>
</span><span id="__span-29-284"><a id="__codelineno-29-284" name="__codelineno-29-284" href="#__codelineno-29-284"></a>4.2.12 If using a Kubelet config file, edit the file to set `tlsCipherSuites` to
</span><span id="__span-29-285"><a id="__codelineno-29-285" name="__codelineno-29-285" href="#__codelineno-29-285"></a>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256
</span><span id="__span-29-286"><a id="__codelineno-29-286" name="__codelineno-29-286" href="#__codelineno-29-286"></a>or to a subset of these values.
</span><span id="__span-29-287"><a id="__codelineno-29-287" name="__codelineno-29-287" href="#__codelineno-29-287"></a>If using executable arguments, edit the kubelet service file
</span><span id="__span-29-288"><a id="__codelineno-29-288" name="__codelineno-29-288" href="#__codelineno-29-288"></a>/lib/systemd/system/kubelet.service on each worker node and
</span><span id="__span-29-289"><a id="__codelineno-29-289" name="__codelineno-29-289" href="#__codelineno-29-289"></a>set the --tls-cipher-suites parameter as follows, or to a subset of these values.
</span><span id="__span-29-290"><a id="__codelineno-29-290" name="__codelineno-29-290" href="#__codelineno-29-290"></a>--tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256
</span><span id="__span-29-291"><a id="__codelineno-29-291" name="__codelineno-29-291" href="#__codelineno-29-291"></a>Based on your system, restart the kubelet service. For example:
</span><span id="__span-29-292"><a id="__codelineno-29-292" name="__codelineno-29-292" href="#__codelineno-29-292"></a>systemctl daemon-reload
</span><span id="__span-29-293"><a id="__codelineno-29-293" name="__codelineno-29-293" href="#__codelineno-29-293"></a>systemctl restart kubelet.service
</span><span id="__span-29-294"><a id="__codelineno-29-294" name="__codelineno-29-294" href="#__codelineno-29-294"></a>
</span><span id="__span-29-295"><a id="__codelineno-29-295" name="__codelineno-29-295" href="#__codelineno-29-295"></a>4.2.13 Decide on an appropriate level for this parameter and set it,
</span><span id="__span-29-296"><a id="__codelineno-29-296" name="__codelineno-29-296" href="#__codelineno-29-296"></a>either via the --pod-max-pids command line parameter or the PodPidsLimit configuration file setting.
</span><span id="__span-29-297"><a id="__codelineno-29-297" name="__codelineno-29-297" href="#__codelineno-29-297"></a>
</span><span id="__span-29-298"><a id="__codelineno-29-298" name="__codelineno-29-298" href="#__codelineno-29-298"></a>4.2.14 Set the parameter, either via the --seccomp-default command line parameter or the
</span><span id="__span-29-299"><a id="__codelineno-29-299" name="__codelineno-29-299" href="#__codelineno-29-299"></a>seccompDefault configuration file setting.
</span><span id="__span-29-300"><a id="__codelineno-29-300" name="__codelineno-29-300" href="#__codelineno-29-300"></a>By default the seccomp profile is not enabled.
</span><span id="__span-29-301"><a id="__codelineno-29-301" name="__codelineno-29-301" href="#__codelineno-29-301"></a>
</span><span id="__span-29-302"><a id="__codelineno-29-302" name="__codelineno-29-302" href="#__codelineno-29-302"></a>4.2.15 Configuring the setting IPAddressDeny=any will deny service to any IP address not specified in the complimentary setting IPAddressAllow configuration parameter (
</span><span id="__span-29-303"><a id="__codelineno-29-303" name="__codelineno-29-303" href="#__codelineno-29-303"></a>IPAddressDeny=any
</span><span id="__span-29-304"><a id="__codelineno-29-304" name="__codelineno-29-304" href="#__codelineno-29-304"></a>IPAddressAllow={{ kubelet_secure_addresses }}
</span><span id="__span-29-305"><a id="__codelineno-29-305" name="__codelineno-29-305" href="#__codelineno-29-305"></a>*Note
</span><span id="__span-29-306"><a id="__codelineno-29-306" name="__codelineno-29-306" href="#__codelineno-29-306"></a>  kubelet_secure_addresses: "localhost link-local {{ kube_pods_subnets |regex_replace(',', ' ') }} {{ kube_node_addresses }} {{ loadbalancer_apiserver.address | default('')"
</span><span id="__span-29-307"><a id="__codelineno-29-307" name="__codelineno-29-307" href="#__codelineno-29-307"></a>By default IPAddressDeny is not enabled.
</span><span id="__span-29-308"><a id="__codelineno-29-308" name="__codelineno-29-308" href="#__codelineno-29-308"></a>
</span><span id="__span-29-309"><a id="__codelineno-29-309" name="__codelineno-29-309" href="#__codelineno-29-309"></a>
</span><span id="__span-29-310"><a id="__codelineno-29-310" name="__codelineno-29-310" href="#__codelineno-29-310"></a>== Summary node ==
</span><span id="__span-29-311"><a id="__codelineno-29-311" name="__codelineno-29-311" href="#__codelineno-29-311"></a>17 checks PASS
</span><span id="__span-29-312"><a id="__codelineno-29-312" name="__codelineno-29-312" href="#__codelineno-29-312"></a>2 checks FAIL
</span><span id="__span-29-313"><a id="__codelineno-29-313" name="__codelineno-29-313" href="#__codelineno-29-313"></a>7 checks WARN
</span><span id="__span-29-314"><a id="__codelineno-29-314" name="__codelineno-29-314" href="#__codelineno-29-314"></a>0 checks INFO
</span><span id="__span-29-315"><a id="__codelineno-29-315" name="__codelineno-29-315" href="#__codelineno-29-315"></a>
</span><span id="__span-29-316"><a id="__codelineno-29-316" name="__codelineno-29-316" href="#__codelineno-29-316"></a>[INFO] 5 Kubernetes Policies
</span><span id="__span-29-317"><a id="__codelineno-29-317" name="__codelineno-29-317" href="#__codelineno-29-317"></a>[INFO] 5.1 RBAC and Service Accounts
</span><span id="__span-29-318"><a id="__codelineno-29-318" name="__codelineno-29-318" href="#__codelineno-29-318"></a>[WARN] 5.1.1 Ensure that the cluster-admin role is only used where required (Manual)
</span><span id="__span-29-319"><a id="__codelineno-29-319" name="__codelineno-29-319" href="#__codelineno-29-319"></a>[PASS] 5.1.2 Minimize access to secrets (Manual)
</span><span id="__span-29-320"><a id="__codelineno-29-320" name="__codelineno-29-320" href="#__codelineno-29-320"></a>[WARN] 5.1.3 Minimize wildcard use in Roles and ClusterRoles (Manual)
</span><span id="__span-29-321"><a id="__codelineno-29-321" name="__codelineno-29-321" href="#__codelineno-29-321"></a>[PASS] 5.1.4 Minimize access to create pods (Manual)
</span><span id="__span-29-322"><a id="__codelineno-29-322" name="__codelineno-29-322" href="#__codelineno-29-322"></a>[WARN] 5.1.5 Ensure that default service accounts are not actively used (Manual)
</span><span id="__span-29-323"><a id="__codelineno-29-323" name="__codelineno-29-323" href="#__codelineno-29-323"></a>[WARN] 5.1.6 Ensure that Service Account Tokens are only mounted where necessary (Manual)
</span><span id="__span-29-324"><a id="__codelineno-29-324" name="__codelineno-29-324" href="#__codelineno-29-324"></a>[WARN] 5.1.7 Avoid use of system:masters group (Manual)
</span><span id="__span-29-325"><a id="__codelineno-29-325" name="__codelineno-29-325" href="#__codelineno-29-325"></a>[WARN] 5.1.8 Limit use of the Bind, Impersonate and Escalate permissions in the Kubernetes cluster (Manual)
</span><span id="__span-29-326"><a id="__codelineno-29-326" name="__codelineno-29-326" href="#__codelineno-29-326"></a>[WARN] 5.1.9 Minimize access to create persistent volumes (Manual)
</span><span id="__span-29-327"><a id="__codelineno-29-327" name="__codelineno-29-327" href="#__codelineno-29-327"></a>[WARN] 5.1.10 Minimize access to the proxy sub-resource of nodes (Manual)
</span><span id="__span-29-328"><a id="__codelineno-29-328" name="__codelineno-29-328" href="#__codelineno-29-328"></a>[WARN] 5.1.11 Minimize access to the approval sub-resource of certificatesigningrequests objects (Manual)
</span><span id="__span-29-329"><a id="__codelineno-29-329" name="__codelineno-29-329" href="#__codelineno-29-329"></a>[WARN] 5.1.12 Minimize access to webhook configuration objects (Manual)
</span><span id="__span-29-330"><a id="__codelineno-29-330" name="__codelineno-29-330" href="#__codelineno-29-330"></a>[WARN] 5.1.13 Minimize access to the service account token creation (Manual)
</span><span id="__span-29-331"><a id="__codelineno-29-331" name="__codelineno-29-331" href="#__codelineno-29-331"></a>[INFO] 5.2 Pod Security Standards
</span><span id="__span-29-332"><a id="__codelineno-29-332" name="__codelineno-29-332" href="#__codelineno-29-332"></a>[WARN] 5.2.1 Ensure that the cluster has at least one active policy control mechanism in place (Manual)
</span><span id="__span-29-333"><a id="__codelineno-29-333" name="__codelineno-29-333" href="#__codelineno-29-333"></a>[WARN] 5.2.2 Minimize the admission of privileged containers (Manual)
</span><span id="__span-29-334"><a id="__codelineno-29-334" name="__codelineno-29-334" href="#__codelineno-29-334"></a>[PASS] 5.2.3 Minimize the admission of containers wishing to share the host process ID namespace (Manual)
</span><span id="__span-29-335"><a id="__codelineno-29-335" name="__codelineno-29-335" href="#__codelineno-29-335"></a>[PASS] 5.2.4 Minimize the admission of containers wishing to share the host IPC namespace (Manual)
</span><span id="__span-29-336"><a id="__codelineno-29-336" name="__codelineno-29-336" href="#__codelineno-29-336"></a>[WARN] 5.2.5 Minimize the admission of containers wishing to share the host network namespace (Manual)
</span><span id="__span-29-337"><a id="__codelineno-29-337" name="__codelineno-29-337" href="#__codelineno-29-337"></a>[WARN] 5.2.6 Minimize the admission of containers with allowPrivilegeEscalation (Manual)
</span><span id="__span-29-338"><a id="__codelineno-29-338" name="__codelineno-29-338" href="#__codelineno-29-338"></a>[WARN] 5.2.7 Minimize the admission of root containers (Manual)
</span><span id="__span-29-339"><a id="__codelineno-29-339" name="__codelineno-29-339" href="#__codelineno-29-339"></a>[WARN] 5.2.8 Minimize the admission of containers with the NET_RAW capability (Manual)
</span><span id="__span-29-340"><a id="__codelineno-29-340" name="__codelineno-29-340" href="#__codelineno-29-340"></a>[WARN] 5.2.9 Minimize the admission of containers with added capabilities (Manual)
</span><span id="__span-29-341"><a id="__codelineno-29-341" name="__codelineno-29-341" href="#__codelineno-29-341"></a>[WARN] 5.2.10 Minimize the admission of containers with capabilities assigned (Manual)
</span><span id="__span-29-342"><a id="__codelineno-29-342" name="__codelineno-29-342" href="#__codelineno-29-342"></a>[WARN] 5.2.11 Minimize the admission of Windows HostProcess containers (Manual)
</span><span id="__span-29-343"><a id="__codelineno-29-343" name="__codelineno-29-343" href="#__codelineno-29-343"></a>[WARN] 5.2.12 Minimize the admission of HostPath volumes (Manual)
</span><span id="__span-29-344"><a id="__codelineno-29-344" name="__codelineno-29-344" href="#__codelineno-29-344"></a>[WARN] 5.2.13 Minimize the admission of containers which use HostPorts (Manual)
</span><span id="__span-29-345"><a id="__codelineno-29-345" name="__codelineno-29-345" href="#__codelineno-29-345"></a>[INFO] 5.3 Network Policies and CNI
</span><span id="__span-29-346"><a id="__codelineno-29-346" name="__codelineno-29-346" href="#__codelineno-29-346"></a>[WARN] 5.3.1 Ensure that the CNI in use supports NetworkPolicies (Manual)
</span><span id="__span-29-347"><a id="__codelineno-29-347" name="__codelineno-29-347" href="#__codelineno-29-347"></a>[WARN] 5.3.2 Ensure that all Namespaces have NetworkPolicies defined (Manual)
</span><span id="__span-29-348"><a id="__codelineno-29-348" name="__codelineno-29-348" href="#__codelineno-29-348"></a>[INFO] 5.4 Secrets Management
</span><span id="__span-29-349"><a id="__codelineno-29-349" name="__codelineno-29-349" href="#__codelineno-29-349"></a>[WARN] 5.4.1 Prefer using Secrets as files over Secrets as environment variables (Manual)
</span><span id="__span-29-350"><a id="__codelineno-29-350" name="__codelineno-29-350" href="#__codelineno-29-350"></a>[WARN] 5.4.2 Consider external secret storage (Manual)
</span><span id="__span-29-351"><a id="__codelineno-29-351" name="__codelineno-29-351" href="#__codelineno-29-351"></a>[INFO] 5.5 Extensible Admission Control
</span><span id="__span-29-352"><a id="__codelineno-29-352" name="__codelineno-29-352" href="#__codelineno-29-352"></a>[WARN] 5.5.1 Configure Image Provenance using ImagePolicyWebhook admission controller (Manual)
</span><span id="__span-29-353"><a id="__codelineno-29-353" name="__codelineno-29-353" href="#__codelineno-29-353"></a>[INFO] 5.6 General Policies
</span><span id="__span-29-354"><a id="__codelineno-29-354" name="__codelineno-29-354" href="#__codelineno-29-354"></a>[WARN] 5.6.1 Create administrative boundaries between resources using namespaces (Manual)
</span><span id="__span-29-355"><a id="__codelineno-29-355" name="__codelineno-29-355" href="#__codelineno-29-355"></a>[WARN] 5.6.2 Ensure that the seccomp profile is set to docker/default in your Pod definitions (Manual)
</span><span id="__span-29-356"><a id="__codelineno-29-356" name="__codelineno-29-356" href="#__codelineno-29-356"></a>[WARN] 5.6.3 Apply SecurityContext to your Pods and Containers (Manual)
</span><span id="__span-29-357"><a id="__codelineno-29-357" name="__codelineno-29-357" href="#__codelineno-29-357"></a>[WARN] 5.6.4 The default namespace should not be used (Manual)
</span><span id="__span-29-358"><a id="__codelineno-29-358" name="__codelineno-29-358" href="#__codelineno-29-358"></a>
</span><span id="__span-29-359"><a id="__codelineno-29-359" name="__codelineno-29-359" href="#__codelineno-29-359"></a>== Remediations policies ==
</span><span id="__span-29-360"><a id="__codelineno-29-360" name="__codelineno-29-360" href="#__codelineno-29-360"></a>5.1.1 Identify all clusterrolebindings to the cluster-admin role. Check if they are used and
</span><span id="__span-29-361"><a id="__codelineno-29-361" name="__codelineno-29-361" href="#__codelineno-29-361"></a>if they need this role or if they could use a role with fewer privileges.
</span><span id="__span-29-362"><a id="__codelineno-29-362" name="__codelineno-29-362" href="#__codelineno-29-362"></a>Where possible, first bind users to a lower privileged role and then remove the
</span><span id="__span-29-363"><a id="__codelineno-29-363" name="__codelineno-29-363" href="#__codelineno-29-363"></a>clusterrolebinding to the cluster-admin role : kubectl delete clusterrolebinding [name]
</span><span id="__span-29-364"><a id="__codelineno-29-364" name="__codelineno-29-364" href="#__codelineno-29-364"></a>Condition: is_compliant is false if rolename is not cluster-admin and rolebinding is cluster-admin.
</span><span id="__span-29-365"><a id="__codelineno-29-365" name="__codelineno-29-365" href="#__codelineno-29-365"></a>
</span><span id="__span-29-366"><a id="__codelineno-29-366" name="__codelineno-29-366" href="#__codelineno-29-366"></a>5.1.3 Where possible replace any use of wildcards ["*"] in roles and clusterroles with specific
</span><span id="__span-29-367"><a id="__codelineno-29-367" name="__codelineno-29-367" href="#__codelineno-29-367"></a>objects or actions.
</span><span id="__span-29-368"><a id="__codelineno-29-368" name="__codelineno-29-368" href="#__codelineno-29-368"></a>Condition: role_is_compliant is false if ["*"] is found in rules.
</span><span id="__span-29-369"><a id="__codelineno-29-369" name="__codelineno-29-369" href="#__codelineno-29-369"></a>Condition: clusterrole_is_compliant is false if ["*"] is found in rules.
</span><span id="__span-29-370"><a id="__codelineno-29-370" name="__codelineno-29-370" href="#__codelineno-29-370"></a>
</span><span id="__span-29-371"><a id="__codelineno-29-371" name="__codelineno-29-371" href="#__codelineno-29-371"></a>5.1.5 Create explicit service accounts wherever a Kubernetes workload requires specific access
</span><span id="__span-29-372"><a id="__codelineno-29-372" name="__codelineno-29-372" href="#__codelineno-29-372"></a>to the Kubernetes API server.
</span><span id="__span-29-373"><a id="__codelineno-29-373" name="__codelineno-29-373" href="#__codelineno-29-373"></a>Modify the configuration of each default service account to include this value
</span><span id="__span-29-374"><a id="__codelineno-29-374" name="__codelineno-29-374" href="#__codelineno-29-374"></a>`automountServiceAccountToken: false`.
</span><span id="__span-29-375"><a id="__codelineno-29-375" name="__codelineno-29-375" href="#__codelineno-29-375"></a>
</span><span id="__span-29-376"><a id="__codelineno-29-376" name="__codelineno-29-376" href="#__codelineno-29-376"></a>5.1.6 Modify the definition of ServiceAccounts and Pods which do not need to mount service
</span><span id="__span-29-377"><a id="__codelineno-29-377" name="__codelineno-29-377" href="#__codelineno-29-377"></a>account tokens to disable it, with `automountServiceAccountToken: false`.
</span><span id="__span-29-378"><a id="__codelineno-29-378" name="__codelineno-29-378" href="#__codelineno-29-378"></a>If both the ServiceAccount and the Pod's .spec specify a value for automountServiceAccountToken, the Pod spec takes precedence.
</span><span id="__span-29-379"><a id="__codelineno-29-379" name="__codelineno-29-379" href="#__codelineno-29-379"></a>Condition: Pod is_compliant to true when
</span><span id="__span-29-380"><a id="__codelineno-29-380" name="__codelineno-29-380" href="#__codelineno-29-380"></a>  - ServiceAccount is automountServiceAccountToken: false and Pod is automountServiceAccountToken: false or notset
</span><span id="__span-29-381"><a id="__codelineno-29-381" name="__codelineno-29-381" href="#__codelineno-29-381"></a>  - ServiceAccount is automountServiceAccountToken: true notset and Pod is automountServiceAccountToken: false
</span><span id="__span-29-382"><a id="__codelineno-29-382" name="__codelineno-29-382" href="#__codelineno-29-382"></a>
</span><span id="__span-29-383"><a id="__codelineno-29-383" name="__codelineno-29-383" href="#__codelineno-29-383"></a>5.1.7 Remove the system:masters group from all users in the cluster.
</span><span id="__span-29-384"><a id="__codelineno-29-384" name="__codelineno-29-384" href="#__codelineno-29-384"></a>
</span><span id="__span-29-385"><a id="__codelineno-29-385" name="__codelineno-29-385" href="#__codelineno-29-385"></a>5.1.8 Where possible, remove the impersonate, bind and escalate rights from subjects.
</span><span id="__span-29-386"><a id="__codelineno-29-386" name="__codelineno-29-386" href="#__codelineno-29-386"></a>
</span><span id="__span-29-387"><a id="__codelineno-29-387" name="__codelineno-29-387" href="#__codelineno-29-387"></a>5.1.9 Where possible, remove create access to PersistentVolume objects in the cluster.
</span><span id="__span-29-388"><a id="__codelineno-29-388" name="__codelineno-29-388" href="#__codelineno-29-388"></a>
</span><span id="__span-29-389"><a id="__codelineno-29-389" name="__codelineno-29-389" href="#__codelineno-29-389"></a>5.1.10 Where possible, remove access to the proxy sub-resource of node objects.
</span><span id="__span-29-390"><a id="__codelineno-29-390" name="__codelineno-29-390" href="#__codelineno-29-390"></a>
</span><span id="__span-29-391"><a id="__codelineno-29-391" name="__codelineno-29-391" href="#__codelineno-29-391"></a>5.1.11 Where possible, remove access to the approval sub-resource of certificatesigningrequests objects.
</span><span id="__span-29-392"><a id="__codelineno-29-392" name="__codelineno-29-392" href="#__codelineno-29-392"></a>
</span><span id="__span-29-393"><a id="__codelineno-29-393" name="__codelineno-29-393" href="#__codelineno-29-393"></a>5.1.12 Where possible, remove access to the validatingwebhookconfigurations or mutatingwebhookconfigurations objects
</span><span id="__span-29-394"><a id="__codelineno-29-394" name="__codelineno-29-394" href="#__codelineno-29-394"></a>
</span><span id="__span-29-395"><a id="__codelineno-29-395" name="__codelineno-29-395" href="#__codelineno-29-395"></a>5.1.13 Where possible, remove access to the token sub-resource of serviceaccount objects.
</span><span id="__span-29-396"><a id="__codelineno-29-396" name="__codelineno-29-396" href="#__codelineno-29-396"></a>
</span><span id="__span-29-397"><a id="__codelineno-29-397" name="__codelineno-29-397" href="#__codelineno-29-397"></a>5.2.1 Ensure that either Pod Security Admission or an external policy control system is in place
</span><span id="__span-29-398"><a id="__codelineno-29-398" name="__codelineno-29-398" href="#__codelineno-29-398"></a>for every namespace which contains user workloads.
</span><span id="__span-29-399"><a id="__codelineno-29-399" name="__codelineno-29-399" href="#__codelineno-29-399"></a>
</span><span id="__span-29-400"><a id="__codelineno-29-400" name="__codelineno-29-400" href="#__codelineno-29-400"></a>5.2.2 Add policies to each namespace in the cluster which has user workloads to restrict the
</span><span id="__span-29-401"><a id="__codelineno-29-401" name="__codelineno-29-401" href="#__codelineno-29-401"></a>admission of privileged containers.
</span><span id="__span-29-402"><a id="__codelineno-29-402" name="__codelineno-29-402" href="#__codelineno-29-402"></a>Audit: the audit list all pods' containers to retrieve their .securityContext.privileged value.
</span><span id="__span-29-403"><a id="__codelineno-29-403" name="__codelineno-29-403" href="#__codelineno-29-403"></a>Condition: is_compliant is false if container's `.securityContext.privileged` is set to `true`.
</span><span id="__span-29-404"><a id="__codelineno-29-404" name="__codelineno-29-404" href="#__codelineno-29-404"></a>Default: by default, there are no restrictions on the creation of privileged containers.
</span><span id="__span-29-405"><a id="__codelineno-29-405" name="__codelineno-29-405" href="#__codelineno-29-405"></a>
</span><span id="__span-29-406"><a id="__codelineno-29-406" name="__codelineno-29-406" href="#__codelineno-29-406"></a>5.2.5 Add policies to each namespace in the cluster which has user workloads to restrict the
</span><span id="__span-29-407"><a id="__codelineno-29-407" name="__codelineno-29-407" href="#__codelineno-29-407"></a>admission of `hostNetwork` containers.
</span><span id="__span-29-408"><a id="__codelineno-29-408" name="__codelineno-29-408" href="#__codelineno-29-408"></a>Audit: the audit retrieves each Pod' spec.hostNetwork.
</span><span id="__span-29-409"><a id="__codelineno-29-409" name="__codelineno-29-409" href="#__codelineno-29-409"></a>Condition: is_compliant is false if Pod's spec.hostNetwork is set to `true`.
</span><span id="__span-29-410"><a id="__codelineno-29-410" name="__codelineno-29-410" href="#__codelineno-29-410"></a>Default: by default, there are no restrictions on the creation of hostNetwork containers.
</span><span id="__span-29-411"><a id="__codelineno-29-411" name="__codelineno-29-411" href="#__codelineno-29-411"></a>
</span><span id="__span-29-412"><a id="__codelineno-29-412" name="__codelineno-29-412" href="#__codelineno-29-412"></a>5.2.6 Add policies to each namespace in the cluster which has user workloads to restrict the
</span><span id="__span-29-413"><a id="__codelineno-29-413" name="__codelineno-29-413" href="#__codelineno-29-413"></a>admission of containers with `.securityContext.allowPrivilegeEscalation` set to `true`.
</span><span id="__span-29-414"><a id="__codelineno-29-414" name="__codelineno-29-414" href="#__codelineno-29-414"></a>Audit: the audit retrieves each Pod's container(s) `.securityContext.allowPrivilegeEscalation`.
</span><span id="__span-29-415"><a id="__codelineno-29-415" name="__codelineno-29-415" href="#__codelineno-29-415"></a>Condition: is_compliant is false if container's `.securityContext.allowPrivilegeEscalation` is set to `true`.
</span><span id="__span-29-416"><a id="__codelineno-29-416" name="__codelineno-29-416" href="#__codelineno-29-416"></a>Default: If notset, privilege escalation is allowed (default to true). However if PSP/PSA is used with a `restricted` profile,
</span><span id="__span-29-417"><a id="__codelineno-29-417" name="__codelineno-29-417" href="#__codelineno-29-417"></a>privilege escalation is explicitly disallowed unless configured otherwise.
</span><span id="__span-29-418"><a id="__codelineno-29-418" name="__codelineno-29-418" href="#__codelineno-29-418"></a>
</span><span id="__span-29-419"><a id="__codelineno-29-419" name="__codelineno-29-419" href="#__codelineno-29-419"></a>5.2.7 Create a policy for each namespace in the cluster, ensuring that either `MustRunAsNonRoot`
</span><span id="__span-29-420"><a id="__codelineno-29-420" name="__codelineno-29-420" href="#__codelineno-29-420"></a>or `MustRunAs` with the range of UIDs not including 0, is set.
</span><span id="__span-29-421"><a id="__codelineno-29-421" name="__codelineno-29-421" href="#__codelineno-29-421"></a>
</span><span id="__span-29-422"><a id="__codelineno-29-422" name="__codelineno-29-422" href="#__codelineno-29-422"></a>5.2.8 Add policies to each namespace in the cluster which has user workloads to restrict the
</span><span id="__span-29-423"><a id="__codelineno-29-423" name="__codelineno-29-423" href="#__codelineno-29-423"></a>admission of containers with the `NET_RAW` capability.
</span><span id="__span-29-424"><a id="__codelineno-29-424" name="__codelineno-29-424" href="#__codelineno-29-424"></a>
</span><span id="__span-29-425"><a id="__codelineno-29-425" name="__codelineno-29-425" href="#__codelineno-29-425"></a>5.2.9 Ensure that `allowedCapabilities` is not present in policies for the cluster unless
</span><span id="__span-29-426"><a id="__codelineno-29-426" name="__codelineno-29-426" href="#__codelineno-29-426"></a>it is set to an empty array.
</span><span id="__span-29-427"><a id="__codelineno-29-427" name="__codelineno-29-427" href="#__codelineno-29-427"></a>Audit: the audit retrieves each Pod's container(s) added capabilities.
</span><span id="__span-29-428"><a id="__codelineno-29-428" name="__codelineno-29-428" href="#__codelineno-29-428"></a>Condition: is_compliant is false if added capabilities are added for a given container.
</span><span id="__span-29-429"><a id="__codelineno-29-429" name="__codelineno-29-429" href="#__codelineno-29-429"></a>Default: Containers run with a default set of capabilities as assigned by the Container Runtime.
</span><span id="__span-29-430"><a id="__codelineno-29-430" name="__codelineno-29-430" href="#__codelineno-29-430"></a>
</span><span id="__span-29-431"><a id="__codelineno-29-431" name="__codelineno-29-431" href="#__codelineno-29-431"></a>5.2.10 Review the use of capabilites in applications running on your cluster. Where a namespace
</span><span id="__span-29-432"><a id="__codelineno-29-432" name="__codelineno-29-432" href="#__codelineno-29-432"></a>contains applications which do not require any Linux capabities to operate consider adding
</span><span id="__span-29-433"><a id="__codelineno-29-433" name="__codelineno-29-433" href="#__codelineno-29-433"></a>a PSP which forbids the admission of containers which do not drop all capabilities.
</span><span id="__span-29-434"><a id="__codelineno-29-434" name="__codelineno-29-434" href="#__codelineno-29-434"></a>
</span><span id="__span-29-435"><a id="__codelineno-29-435" name="__codelineno-29-435" href="#__codelineno-29-435"></a>5.2.11 Add policies to each namespace in the cluster which has user workloads to restrict the
</span><span id="__span-29-436"><a id="__codelineno-29-436" name="__codelineno-29-436" href="#__codelineno-29-436"></a>admission of containers that have `.securityContext.windowsOptions.hostProcess` set to `true`.
</span><span id="__span-29-437"><a id="__codelineno-29-437" name="__codelineno-29-437" href="#__codelineno-29-437"></a>
</span><span id="__span-29-438"><a id="__codelineno-29-438" name="__codelineno-29-438" href="#__codelineno-29-438"></a>5.2.12 Add policies to each namespace in the cluster which has user workloads to restrict the
</span><span id="__span-29-439"><a id="__codelineno-29-439" name="__codelineno-29-439" href="#__codelineno-29-439"></a>admission of containers with `hostPath` volumes.
</span><span id="__span-29-440"><a id="__codelineno-29-440" name="__codelineno-29-440" href="#__codelineno-29-440"></a>
</span><span id="__span-29-441"><a id="__codelineno-29-441" name="__codelineno-29-441" href="#__codelineno-29-441"></a>5.2.13 Add policies to each namespace in the cluster which has user workloads to restrict the
</span><span id="__span-29-442"><a id="__codelineno-29-442" name="__codelineno-29-442" href="#__codelineno-29-442"></a>admission of containers which use `hostPort` sections.
</span><span id="__span-29-443"><a id="__codelineno-29-443" name="__codelineno-29-443" href="#__codelineno-29-443"></a>
</span><span id="__span-29-444"><a id="__codelineno-29-444" name="__codelineno-29-444" href="#__codelineno-29-444"></a>5.3.1 If the CNI plugin in use does not support network policies, consideration should be given to
</span><span id="__span-29-445"><a id="__codelineno-29-445" name="__codelineno-29-445" href="#__codelineno-29-445"></a>making use of a different plugin, or finding an alternate mechanism for restricting traffic
</span><span id="__span-29-446"><a id="__codelineno-29-446" name="__codelineno-29-446" href="#__codelineno-29-446"></a>in the Kubernetes cluster.
</span><span id="__span-29-447"><a id="__codelineno-29-447" name="__codelineno-29-447" href="#__codelineno-29-447"></a>
</span><span id="__span-29-448"><a id="__codelineno-29-448" name="__codelineno-29-448" href="#__codelineno-29-448"></a>5.3.2 Follow the documentation and create NetworkPolicy objects as you need them.
</span><span id="__span-29-449"><a id="__codelineno-29-449" name="__codelineno-29-449" href="#__codelineno-29-449"></a>
</span><span id="__span-29-450"><a id="__codelineno-29-450" name="__codelineno-29-450" href="#__codelineno-29-450"></a>5.4.1 If possible, rewrite application code to read Secrets from mounted secret files, rather than
</span><span id="__span-29-451"><a id="__codelineno-29-451" name="__codelineno-29-451" href="#__codelineno-29-451"></a>from environment variables.
</span><span id="__span-29-452"><a id="__codelineno-29-452" name="__codelineno-29-452" href="#__codelineno-29-452"></a>
</span><span id="__span-29-453"><a id="__codelineno-29-453" name="__codelineno-29-453" href="#__codelineno-29-453"></a>5.4.2 Refer to the Secrets management options offered by your cloud provider or a third-party
</span><span id="__span-29-454"><a id="__codelineno-29-454" name="__codelineno-29-454" href="#__codelineno-29-454"></a>secrets management solution.
</span><span id="__span-29-455"><a id="__codelineno-29-455" name="__codelineno-29-455" href="#__codelineno-29-455"></a>
</span><span id="__span-29-456"><a id="__codelineno-29-456" name="__codelineno-29-456" href="#__codelineno-29-456"></a>5.5.1 Follow the Kubernetes documentation and setup image provenance.
</span><span id="__span-29-457"><a id="__codelineno-29-457" name="__codelineno-29-457" href="#__codelineno-29-457"></a>
</span><span id="__span-29-458"><a id="__codelineno-29-458" name="__codelineno-29-458" href="#__codelineno-29-458"></a>5.6.1 Follow the documentation and create namespaces for objects in your deployment as you need
</span><span id="__span-29-459"><a id="__codelineno-29-459" name="__codelineno-29-459" href="#__codelineno-29-459"></a>them.
</span><span id="__span-29-460"><a id="__codelineno-29-460" name="__codelineno-29-460" href="#__codelineno-29-460"></a>
</span><span id="__span-29-461"><a id="__codelineno-29-461" name="__codelineno-29-461" href="#__codelineno-29-461"></a>5.6.2 Use `securityContext` to enable the docker/default seccomp profile in your pod definitions.
</span><span id="__span-29-462"><a id="__codelineno-29-462" name="__codelineno-29-462" href="#__codelineno-29-462"></a>An example is as below:
</span><span id="__span-29-463"><a id="__codelineno-29-463" name="__codelineno-29-463" href="#__codelineno-29-463"></a>  securityContext:
</span><span id="__span-29-464"><a id="__codelineno-29-464" name="__codelineno-29-464" href="#__codelineno-29-464"></a>    seccompProfile:
</span><span id="__span-29-465"><a id="__codelineno-29-465" name="__codelineno-29-465" href="#__codelineno-29-465"></a>      type: RuntimeDefault
</span><span id="__span-29-466"><a id="__codelineno-29-466" name="__codelineno-29-466" href="#__codelineno-29-466"></a>
</span><span id="__span-29-467"><a id="__codelineno-29-467" name="__codelineno-29-467" href="#__codelineno-29-467"></a>5.6.3 Follow the Kubernetes documentation and apply SecurityContexts to your Pods. For a
</span><span id="__span-29-468"><a id="__codelineno-29-468" name="__codelineno-29-468" href="#__codelineno-29-468"></a>suggested list of SecurityContexts, you may refer to the CIS Security Benchmark for Docker
</span><span id="__span-29-469"><a id="__codelineno-29-469" name="__codelineno-29-469" href="#__codelineno-29-469"></a>Containers.
</span><span id="__span-29-470"><a id="__codelineno-29-470" name="__codelineno-29-470" href="#__codelineno-29-470"></a>
</span><span id="__span-29-471"><a id="__codelineno-29-471" name="__codelineno-29-471" href="#__codelineno-29-471"></a>5.6.4 Ensure that namespaces are created to allow for appropriate segregation of Kubernetes
</span><span id="__span-29-472"><a id="__codelineno-29-472" name="__codelineno-29-472" href="#__codelineno-29-472"></a>resources and that all new resources are created in a specific namespace.
</span><span id="__span-29-473"><a id="__codelineno-29-473" name="__codelineno-29-473" href="#__codelineno-29-473"></a>
</span><span id="__span-29-474"><a id="__codelineno-29-474" name="__codelineno-29-474" href="#__codelineno-29-474"></a>
</span><span id="__span-29-475"><a id="__codelineno-29-475" name="__codelineno-29-475" href="#__codelineno-29-475"></a>== Summary policies ==
</span><span id="__span-29-476"><a id="__codelineno-29-476" name="__codelineno-29-476" href="#__codelineno-29-476"></a>4 checks PASS
</span><span id="__span-29-477"><a id="__codelineno-29-477" name="__codelineno-29-477" href="#__codelineno-29-477"></a>0 checks FAIL
</span><span id="__span-29-478"><a id="__codelineno-29-478" name="__codelineno-29-478" href="#__codelineno-29-478"></a>31 checks WARN
</span><span id="__span-29-479"><a id="__codelineno-29-479" name="__codelineno-29-479" href="#__codelineno-29-479"></a>0 checks INFO
</span><span id="__span-29-480"><a id="__codelineno-29-480" name="__codelineno-29-480" href="#__codelineno-29-480"></a>
</span><span id="__span-29-481"><a id="__codelineno-29-481" name="__codelineno-29-481" href="#__codelineno-29-481"></a>== Summary total ==
</span><span id="__span-29-482"><a id="__codelineno-29-482" name="__codelineno-29-482" href="#__codelineno-29-482"></a>68 checks PASS
</span><span id="__span-29-483"><a id="__codelineno-29-483" name="__codelineno-29-483" href="#__codelineno-29-483"></a>12 checks FAIL
</span><span id="__span-29-484"><a id="__codelineno-29-484" name="__codelineno-29-484" href="#__codelineno-29-484"></a>53 checks WARN
</span><span id="__span-29-485"><a id="__codelineno-29-485" name="__codelineno-29-485" href="#__codelineno-29-485"></a>0 checks INFO
</span></code></pre></div>
<h2 id="appendix-more-grafana-dashboards-for-prometheous">Appendix: more Grafana dashboards for Prometheous</h2>
<p>Prometheus will be scrapping many more metrics about the Kubernetes cluster and its
workloads and these can be explored using additional Grafana dashboards:</p>
<ul>
<li>
<p><a href="https://grafana.com/grafana/dashboards/21410-kubernetes-overview/"><strong>Kubernetes / Overview</strong> (ID: 21410)</a>
    is designed to be a one-stop solution for monitoring your Kubernetes cluster-
    This dashboard provides a comprehensive view of the health and resource utilization
    within a Kubernetes cluster. It is designed to assist cluster administrators and
    DevOps engineers in monitoring and optimizing their deployments.</p>
</li>
<li>
<p><a href="https://grafana.com/grafana/dashboards/15760-kubernetes-views-pods/"><strong>Kubernetes / Views / Pods</strong> (ID: 15760)</a>
    is a modern 'Pods View' dashboard for your Kubernetes cluster(s). Made for
    kube-prometheus-stack and take advantage of the latest Grafana features.</p>
</li>
<li>
<p><a href="https://grafana.com/grafana/dashboards/893-main/"><strong>Docker and system monitoring</strong> (ID: 893)</a>
    is a simple overview of the most important Docker host and container metrics.
    This dashboard display Docker and system metric, the aim it’s to have all the
    metric on one dashboard. The first lines represents the system metric with gauge
    and text/graph (easy to visualize and minimalist).</p>
</li>
<li>
<p><a href="https://grafana.com/grafana/dashboards/21073-monitoring-golden-signals/"><strong>Monitoring Golden Signals for Kubernetes</strong> (ID: 21073)</a>
    is a comprehensive Grafana dashboard that provides a detailed view of the key
    metrics that can be categorized under the Four Golden Signals: Latency, Traffic,
    Errors, and Saturation. Designed for quick issue identification, this dashboard
    offers real-time insights into the performance and health of your Kubernetes
    cluster. Ideal for DevOps teams and SREs, this dashboard is your go-to resource for
    proactive Kubernetes cluster management.</p>
</li>
</ul>







  
  



  


  



<script src="https://giscus.app/client.js" data-repo="stibbons1990/hex" data-repo-id="R_kgDOKXTsSg" data-category="Announcements" data-category-id="DIC_kwDOKXTsSs4CqHDX" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="1" data-input-position="top" data-theme="preferred_color_scheme" data-lang="en" crossorigin="anonymous" async>
</script>

      
    </article>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
        
      
      <nav class="md-footer__inner md-grid" aria-label="Footer">
        
          
          <a href="../../18/replacing-ingress-nginx-with-pomerium/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Replacing Ingress-NGINX with Pomerium">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Replacing Ingress-NGINX with Pomerium
              </div>
            </div>
          </a>
        
        
          
          <a href="../../../../2026/01/10/upgrading-single-node-kubernetes-cluster-on-ubuntu-studio-2404-octavo/" class="md-footer__link md-footer__link--next" aria-label="Next: Upgrading single-node Kubernetes cluster on Ubuntu Studio 24.04 (octavo)">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Upgrading single-node Kubernetes cluster on Ubuntu Studio 24.04 (octavo)
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2019-2025 Ponder Stibbons
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../../..", "features": ["content.code.copy", "navigation.expand", "navigation.footer", "navigation.top", "search.highlight", "search.suggest"], "search": "../../../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>